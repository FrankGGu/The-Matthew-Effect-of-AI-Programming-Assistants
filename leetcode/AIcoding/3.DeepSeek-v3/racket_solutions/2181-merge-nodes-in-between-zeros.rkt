(define/contract (merge-nodes head)
  (-> (or/c list-node? #f) (or/c list-node? #f))
  (define dummy (new list-node% [val 0] [next #f]))
  (define tail dummy)
  (define current head)
  (define sum 0)
  (while (not (eq? current #f))
    (if (= (send current get-val) 0)
        (begin
          (when (> sum 0)
            (define new-node (new list-node% [val sum] [next #f]))
            (send tail set-next new-node)
            (set! tail new-node)
            (set! sum 0))
          (set! current (send current get-next)))
        (begin
          (set! sum (+ sum (send current get-val)))
          (set! current (send current get-next)))))
  (send dummy get-next))