(define (longestPalindrome s)
  (define (expandAroundCenter left right)
    (let loop ((l left) (r right))
      (if (and (>= l 0) (< r (string-length s)) (char=? (string-ref s l) (string-ref s r)))
          (loop (sub1 l) (add1 r))
          (sub1 r))))

  (define (findLongestPalindrome)
    (let loop ((i 0) (max-len 0) (start 0))
      (if (< i (string-length s))
          (let* ((len1 (expandAroundCenter i i))
                 (len2 (expandAroundCenter i (add1 i)))
                 (len (max len1 len2)))
            (if (> len max-len)
                (loop (add1 i) len (sub1 (+ i len)))
                (loop (add1 i) max-len start)))
          (substring s start (+ start max-len)))))

  (findLongestPalindrome))