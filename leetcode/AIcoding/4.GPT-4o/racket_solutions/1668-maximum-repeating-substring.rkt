(define (max-repeating substring sequence)
  (define (count-repeats sub seq)
    (let loop ((count 0)
               (start 0))
      (let ([pos (string-contains seq sub #:start start)])
        (if pos
            (loop (+ count 1) (+ pos (string-length sub)))
            count))))
  (define max-count 0)
  (for ((i 1 (+ 1 (string-length substring))))
    (let ([sub (substring substring 0 i)])
      (define count (count-repeats sub sequence))
      (when (> count max-count)
        (set! max-count count))))
  max-count)