(define (minimizeMalwareSpread graph initial)
  (define n (length graph))
  (define (dfs node visited)
    (for ([neighbor (in-list (vector->list (vector-ref graph node)))])
      (when (and (= neighbor 1) (not (vector-ref visited neighbor)))
        (vector-set! visited neighbor #t)
        (dfs neighbor visited))))

  (define visited (make-vector n #f))
  (define clusters '())

  (for ([i (in-range n)])
    (when (not (vector-ref visited i))
      (define current-cluster '())
      (vector-set! visited i #t)
      (set! current-cluster (cons i current-cluster))
      (dfs i visited)
      (set! clusters (cons current-cluster clusters))))

  (define malware-count (make-vector n 0))
  (for ([m (in-list initial)])
    (for ([c (in-list clusters)])
      (when (member m c)
        (for ([node (in-list c)])
          (vector-set! malware-count node (+ 1 (vector-ref malware-count node)))))))

  (define (compare a b)
    (if (= (vector-ref malware-count a) (vector-ref malware-count b))
        (if (< a b) a b)
        (if (< (vector-ref malware-count a) (vector-ref malware-count b) a b)
          a b)))

  (define result (foldl compare (car initial) (cdr initial)))
  result)