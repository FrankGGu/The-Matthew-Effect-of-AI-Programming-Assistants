(define (minOperations target arr)
  (define sorted-target (sort target <))
  (define indices (map (lambda (x) (index-of (sort arr <) x)) sorted-target))
  (define lis-length (length (longest-increasing-subsequence indices)))
  (- (length target) lis-length))

(define (longest-increasing-subsequence seq)
  (define dp (make-vector (length seq) 1))
  (for ((i (in-range 1 (length seq))))
    (for ((j (in-range i)))
      (when (> (vector-ref seq j) (vector-ref seq i))
        (vector-set! dp i (max (vector-ref dp i) (1+ (vector-ref dp j)))))))
  (apply max (vector->list dp)))

(define (index-of lst x)
  (for/fold ([idx -1]) ([el lst] [i (in-naturals)])
    (if (equal? el x)
        (if (= idx -1) i idx)
        idx)))

(define (in-naturals)
  (let loop ((n 0))
    (cons n (loop (add1 n)))))

(define (sort lst pred)
  (if (null? lst)
      '()
      (let* ((pivot (car lst))
             (less (filter (lambda (x) (pred x pivot)) (cdr lst)))
             (greater (filter (lambda (x) (not (pred x pivot))) (cdr lst))))
        (append (sort less pred) (list pivot) (sort greater pred)))))