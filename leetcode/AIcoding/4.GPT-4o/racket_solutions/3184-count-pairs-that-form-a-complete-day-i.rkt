(define (countPairs timePoints)
  (define time->minutes
    (lambda (time)
      (+ (* (string->number (substring time 0 2)) 60)
         (string->number (substring time 3 5)))))
  (define minutes (map time->minutes timePoints))
  (define sorted-minutes (sort minutes <))
  (define n (length sorted-minutes))
  (define (countPairsInRange start end)
    (let loop ((i 0) (count 0))
      (if (>= i n)
          count
          (let ((j (if (< (list-ref sorted-minutes i) end)
                       (loop (+ i 1) count)
                       (loop (+ i 1) (+ count (- j i))))))
            (if (>= j n)
                count
                (loop (+ i 1) count))))))
  (let ((count1 (countPairsInRange 0 1440)))
    (+ count1
       (countPairsInRange 0 60)
       (countPairsInRange 60 120)
       (countPairsInRange 120 180)
       (countPairsInRange 180 240)
       (countPairsInRange 240 300)
       (countPairsInRange 300 360)
       (countPairsInRange 360 420)
       (countPairsInRange 420 480)
       (countPairsInRange 480 540)
       (countPairsInRange 540 600)
       (countPairsInRange 600 660)
       (countPairsInRange 660 720)
       (countPairsInRange 720 780)
       (countPairsInRange 780 840)
       (countPairsInRange 840 900)
       (countPairsInRange 900 960)
       (countPairsInRange 960 1020)
       (countPairsInRange 1020 1080)
       (countPairsInRange 1080 1140)
       (countPairsInRange 1140 1200)
       (countPairsInRange 1200 1260)
       (countPairsInRange 1260 1320)
       (countPairsInRange 1320 1380)
       (countPairsInRange 1380 1440)))))

(define (countPairs timePoints)
  (countPairs timePoints))