(define (isAlienSorted words order)
  (define order-map (make-hash))
  (for ([i (in-range (string-length order))])
    (hash-set! order-map (string-ref order i) i))
  (define (compare-words w1 w2)
    (for ([i (in-range (min (string-length w1) (string-length w2)))])
      (let ([c1 (string-ref w1 i)]
            [c2 (string-ref w2 i)])
        (when (not (= c1 c2))
          (return (< (hash-ref order-map c1) (hash-ref order-map c2))))))
    (< (string-length w1) (string-length w2)))
  (for/list ([i (in-range (sub1 (length words)))])
    (if (not (compare-words (list-ref words i) (list-ref words (add1 i))))
        (return #f)))
  #t)