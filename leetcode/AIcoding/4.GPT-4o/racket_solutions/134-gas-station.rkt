(define (canCompleteCircuit gas cost)
  (define n (length gas))
  (define (helper start)
    (define (loop idx total-gas total-cost)
      (if (= idx n)
          (if (>= total-gas total-cost) start -1)
          (let ((new-gas (+ total-gas (- (list-ref gas idx) (list-ref cost idx)))))
            (if (>= new-gas 0)
                (loop (+ idx 1) new-gas total-cost)
                (if (>= total-gas total-cost)
                    (loop (+ idx 1) new-gas (+ total-cost (list-ref cost idx)))
                    -1)))))
    (loop start 0 0))

  (define (find-start)
    (for/fold ([i 0]) ([j (in-range n)])
      (if (>= (list-ref gas j) (list-ref cost j))
          (begin (set! i j) (if (helper j) j -1))
          i)))

  (find-start))