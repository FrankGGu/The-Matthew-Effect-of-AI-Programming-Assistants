(define (h-index citations)
  (define (count-h-index h)
    (count (lambda (x) (>= x h)) citations))
  (define (binary-search low high)
    (if (<= low high)
        (let ([mid (quotient (+ low high) 2)])
          (if (= (count-h-index mid) mid)
              (binary-search (+ mid 1) high)
              (binary-search low (- mid 1))))
        high))
  (binary-search 0 (length citations)))