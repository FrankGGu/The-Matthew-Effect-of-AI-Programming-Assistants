(define (shiftingLetters s shifts)
  (define n (string-length s))
  (define shift-list (make-vector n 0))
  (for ([i (in-range (vector-length shifts))])
    (define [start end direction]
      (if (= direction 1)
          (for ([j (in-range (vector-ref shifts i) (+ (vector-ref shifts i) (vector-ref shifts (+ i 1))))])
            (vector-set! shift-list j (+ (vector-ref shift-list j) 1)))
          (for ([j (in-range (vector-ref shifts i) (+ (vector-ref shifts i) (vector-ref shifts (+ i 1))))])
            (vector-set! shift-list j (- (vector-ref shift-list j) 1)))))
    (start (vector-ref shifts i) (vector-ref shifts (+ i 1)) (if (even? i) 1 -1)))
  (define result (make-string n))
  (for ([i (in-range n)])
    (define char (string-ref s i))
    (define shift (vector-ref shift-list i))
    (define new-char (integer->char (modulo (+ (char->integer char) shift -97) 26)))
    (string-set! result i new-char))
  result)

(define (shiftingLettersII s shifts)
  (shiftingLetters s (append shifts (list 0))))