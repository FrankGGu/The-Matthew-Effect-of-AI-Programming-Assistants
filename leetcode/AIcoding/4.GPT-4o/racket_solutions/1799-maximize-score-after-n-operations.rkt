(define (maxScore nums)
  (define n (length nums))
  (define dp (make-vector (expt 2 n) 0))
  (define (gcd a b)
    (if (= b 0) a (gcd b (modulo a b))))
  (define (rec state op)
    (if (= op (/ n 2)) 
        0 
        (let loop ((i 0) (max-score 0))
          (if (< i n)
              (let* ((bitmask (bitwise-arithmetic-shift-left 1 i))
                     (next-state (bitwise-ior state bitmask))
                     (score (+ (gcd (vector-ref nums i) (vector-ref nums (+ i 1))) (* (1+ op) (gcd (vector-ref nums i) (vector-ref nums (+ i 1)))))))
                (loop (+ i 1) (max max-score (+ score (rec next-state (1+ op)))))
              max-score))))
  (rec 0 0))