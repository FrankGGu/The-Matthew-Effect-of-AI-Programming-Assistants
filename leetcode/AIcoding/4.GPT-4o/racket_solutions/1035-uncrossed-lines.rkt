(define (maxUncrossedLines A B)
  (define n (length A))
  (define m (length B))
  (define dp (make-vector (add1 n) (make-vector (add1 m) 0)))
  (for ([i (in-range 1 (add1 n))])
    (for ([j (in-range 1 (add1 m))])
      (if (= (list-ref A (- i 1)) (list-ref B (- j 1)))
          (vector-set! dp i j (+ 1 (vector-ref (vector-ref dp (- i 1)) (- j 1))))
          (vector-set! dp i j (max (vector-ref (vector-ref dp (- i 1)) j)
                                    (vector-ref (vector-ref dp i (- j 1))))))))
  (vector-ref (vector-ref dp n) m))