(define (firstMissingPositive nums)
  (define n (length nums))
  (for ([i nums])
    (if (and (>= i 1) (<= i n))
        (let ([temp (list-ref nums (- i 1))])
          (list-set! nums (- i 1) (+ temp n)))))
  (for ([i (range 1 (+ n 1))])
    (if (= (list-ref nums (- i 1)) i)
        (begin (set! nums (list-set! nums (- i 1) 0)))))
  (for ([i (range 1 (+ n 1))])
    (if (= (list-ref nums (- i 1)) 0)
        (return i)))
  (+ n 1))

(define (list-set! lst idx val)
  (if (null? lst)
      '()
      (cons (if (= idx 0) val (car lst))
            (list-set! (cdr lst) (sub1 idx) val))))