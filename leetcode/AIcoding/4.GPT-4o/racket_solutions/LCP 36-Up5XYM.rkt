(define (maxEqualFreq nums)
  (define freq (make-hash))
  (for-each (lambda (x) (hash-set! freq x (+ 1 (hash-ref freq x 0)))) nums)
  (define freq-count (make-hash))
  (for-each (lambda (v) (hash-set! freq-count v (+ 1 (hash-ref freq-count v 0)))) (hash-values freq))
  (define counts (hash->list freq-count))
  (define total (length nums))
  (define (check)
    (or (<= (length counts) 1)
        (and (= (length counts) 2)
             (or (and (= (car counts) 1) (= (cadr counts) 1))
                 (or (and (= (car counts) 1) (= (cadr counts) (+ 1 (car counts))))
                     (and (= (cadr counts) 1) (= (car counts) (+ 1 (cadr counts)))))))))
  (if (check)
      total
      (define max-freq (apply max counts))
      (if (= (length counts) 2)
          (if (or (= (car counts) 1) (= (cadr counts) 1))
              (- total 1)
              (- total (if (= (car counts) max-freq) (car counts) (cadr counts)))))))
)

(maxEqualFreq '(1 1 2 2 3 3 4 4 5 5))