(define (min-transportation-cost costs)
  (define n (length costs))
  (define dp (make-vector (+ n 1) (make-vector (+ n 1) (make-vector (+ n 1) +inf.0))))
  (vector-set! dp 0 0)
  (for ([i (in-range n)])
    (for ([j (in-range (add1 n))])
      (for ([k (in-range (add1 n))])
        (when (and (> i 0) (> j 0) (> k 0))
          (vector-set! dp i j (min (vector-ref dp i j) (+ (vector-ref dp (- i 1)) (vector-ref (vector-ref costs (- j 1)) (- k 1)))))))))
  (for ([i (in-range n)])
    (for ([j (in-range n)])
      (when (and (> i 0) (> j 0))
        (vector-set! dp i j (min (vector-ref dp i j) (+ (vector-ref dp (- i 1)) (vector-ref dp j))))))
      (for ([k (in-range n)])
        (when (and (> i 0) (> j 0) (> k 0))
          (vector-set! dp i j (min (vector-ref dp i j) (+ (vector-ref dp i (- j 1)) (vector-ref (vector-ref costs (- k 1)) (- i 1)))))))))
  (vector-ref dp n n))

(min-transportation-cost '((1 2 3) (4 5 6) (7 8 9)))