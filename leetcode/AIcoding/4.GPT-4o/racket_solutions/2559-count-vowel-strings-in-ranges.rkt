(define (vowel-strings-in-ranges s ranges)
  (define vowels (set '(#\a #\e #\i #\o #\u)))
  (define (is-vowel-string str)
    (and (not (string-empty? str))
         (for/and ([ch (in-string str)])
           (set-member? vowels ch))))
  (define (count-vowel-strings start end)
    (define count 0)
    (for ([i (in-range start (+ end 1))])
      (when (is-vowel-string (substring s i (+ i 1)))
        (set! count (+ count 1))))
    count)
  (for/list ([range ranges])
    (count-vowel-strings (car range) (cadr range))))