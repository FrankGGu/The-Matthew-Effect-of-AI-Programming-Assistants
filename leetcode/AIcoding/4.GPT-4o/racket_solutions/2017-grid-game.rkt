(define (gridGame grid)
  (define n (length grid))
  (define top (map car grid))
  (define bottom (map cdr grid))
  (define prefix-sum-top (map (lambda (x) (if (zero? x) 0 (+ x (if (zero? (car (if (null? prefix-sum-top) '(0) prefix-sum-top))) 0 (car (if (null? prefix-sum-top) '(0) prefix-sum-top))))))
                               (reverse (scanl + 0 top))))
  (define prefix-sum-bottom (map (lambda (x) (if (zero? x) 0 (+ x (if (zero? (car (if (null? prefix-sum-bottom) '(0) prefix-sum-bottom))) 0 (car (if (null? prefix-sum-bottom) '(0) prefix-sum-bottom))))))
                               (reverse (scanl + 0 bottom))))
  (define max (apply max (map + prefix-sum-top prefix-sum-bottom)))
  max)