(define (sumOfDistancesInTree n edges)
  (define tree (make-vector n '()))
  (for-each (lambda (edge)
              (let ((u (car edge))
                    (v (cadr edge)))
                (vector-set! tree u (cons v (vector-ref tree u)))
                (vector-set! tree v (cons u (vector-ref tree v)))))
            edges)

  (define count (make-vector n 1))
  (define ans (make-vector n 0))

  (define (dfs1 node parent)
    (for-each (lambda (child)
                (when (not (= child parent))
                  (dfs1 child node)
                  (vector-set! ans node (+ (vector-ref ans node) (vector-ref ans child) (vector-ref count child)))
                  (vector-set! count node (+ (vector-ref count node) (vector-ref count child)))))
              (vector-ref tree node)))

  (define (dfs2 node parent)
    (for-each (lambda (child)
                (when (not (= child parent))
                  (vector-set! ans child (+ (vector-ref ans node) (- n (vector-ref count child)))))
                  (dfs2 child node)))
              (vector-ref tree node)))

  (dfs1 0 -1)
  (dfs2 0 -1)
  (vector->list ans))