(define (criticalConnections n connections)
  (define graph (make-vector n '()))
  (for-each (lambda (conn)
              (let* ((u (car conn))
                     (v (cadr conn)))
                (vector-set! graph u (cons v (vector-ref graph u)))
                (vector-set! graph v (cons u (vector-ref graph v)))))
            connections)

  (define visited (make-vector n #f))
  (define disc (make-vector n #f))
  (define low (make-vector n #f))
  (define time (vector 0))
  (define result '())

  (define (dfs u parent)
    (vector-set! visited u #t)
    (vector-set! disc u (vector-ref time 0))
    (vector-set! low u (vector-ref time 0))
    (vector-set! time 0 (+ (vector-ref time 0) 1))

    (for-each (lambda (v)
                (if (eq? v parent)
                    '()
                    (if (not (vector-ref visited v))
                        (begin
                          (dfs v u)
                          (vector-set! low u (min (vector-ref low u) (vector-ref low v)))
                          (when (> (vector-ref low v) (vector-ref disc u))
                            (set! result (cons (list u v) result)))
                          )
                        (vector-set! low u (min (vector-ref low u) (vector-ref disc v)))))
                )
              (vector-ref graph u)))

  (for ((i (in-range n)))
    (when (not (vector-ref visited i))
      (dfs i -1)))

  result)