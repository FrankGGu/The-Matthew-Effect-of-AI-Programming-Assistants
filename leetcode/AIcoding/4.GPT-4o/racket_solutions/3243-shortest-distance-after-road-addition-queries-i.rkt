(define (shortest-distance n roads queries)
  (define graph (make-vector n (lambda () (make-vector n +inf.0))))
  (for-each (lambda (road)
              (let* ((u (car road))
                     (v (cadr road))
                     (d (caddr road)))
                (vector-set! (vector-ref graph u) v d)
                (vector-set! (vector-ref graph v) u d)))
            roads)
  (for-each (lambda (i)
              (vector-set! (vector-ref graph i) i 0))
            (range n))
  (for-each (lambda (k)
              (for-each (lambda (i)
                          (for-each (lambda (j)
                                      (vector-set! (vector-ref graph i) j
                                                    (min (vector-ref (vector-ref graph i) j)
                                                         (+ (vector-ref (vector-ref graph i) k)
                                                            (vector-ref (vector-ref graph k) j)))))
                                    (range n)))
                        (range n)))
            (range n))
  (define result '())
  (for-each (lambda (query)
              (let* ((u (car query))
                     (v (cadr query)))
                (vector-set! result (length result)
                             (if (= (vector-ref (vector-ref graph u) v) +inf.0)
                                 -1
                                 (vector-ref (vector-ref graph u) v)))))
            queries)
  result)

(define (shortest-distance-after-road-addition n roads queries)
  (define distances (shortest-distance n roads queries))
  distances)