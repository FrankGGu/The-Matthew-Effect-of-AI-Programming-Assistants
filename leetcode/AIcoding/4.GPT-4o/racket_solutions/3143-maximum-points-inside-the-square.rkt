(define (maxPoints points)
  (define (count-points-in-square center side)
    (let ((x1 (- (car center) (/ side 2)))
          (y1 (- (cadr center) (/ side 2)))
          (x2 (+ (car center) (/ side 2)))
          (y2 (+ (cadr center) (/ side 2))))
      (length (filter (lambda (p)
                        (and (<= x1 (car p) x2)
                             (<= y1 (cadr p) y2)))
                      points))))

  (define (search-squares)
    (for*/list ((p1 points)
                (p2 points))
      (let ((center (list (/ (+ (car p1) (car p2)) 2)
                          (/ (+ (cadr p1) (cadr p2)) 2)))
            (side (max (abs (- (car p1) (car p2)))
                        (abs (- (cadr p1) (cadr p2))))))
        (count-points-in-square center side))))

  (apply max (search-squares)))

(define (maxPointsWrapper points)
  (maxPoints (map (lambda (p) (list (car p) (cadr p))) points)))