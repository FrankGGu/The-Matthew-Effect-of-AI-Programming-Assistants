(define (max-absolute-sum nums)
  (define (max-sum arr)
    (define max-so-far 0)
    (define max-ending-here 0)
    (for-each (lambda (x)
                (set! max-ending-here (max x (+ max-ending-here x)))
                (set! max-so-far (max max-so-far max-ending-here)))
              arr)
    max-so-far)
  (max (max-sum nums) (max-sum (map - nums))))