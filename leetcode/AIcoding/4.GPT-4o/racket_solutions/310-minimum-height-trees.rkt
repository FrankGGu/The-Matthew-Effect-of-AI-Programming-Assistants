(define (find-min-height-trees n edges)
  (if (zero? n) '()
      (if (= n 1) (list 0)
          (let loop ([adj (make-vector n '())] [in-degrees (make-vector n 0)])
            (for ([edge edges])
              (let ([u (car edge)]
                    [v (cadr edge)])
                (vector-set! adj u (cons v (vector-ref adj u)))
                (vector-set! adj v (cons u (vector-ref adj v)))
                (vector-set! in-degrees u (+ 1 (vector-ref in-degrees u)))
                (vector-set! in-degrees v (+ 1 (vector-ref in-degrees v)))))
            (let ([leaves (for/list ([i (in-range n)] #:when (= (vector-ref in-degrees i) 1)) i)])
              (let loop ([leaves leaves] [count n])
                (when (> count 2)
                  (define new-leaves '())
                  (for ([leaf leaves])
                    (for ([neighbor (vector-ref adj leaf)])
                      (vector-set! in-degrees neighbor (- (vector-ref in-degrees neighbor) 1))
                      (when (= (vector-ref in-degrees neighbor) 1)
                        (set! new-leaves (cons neighbor new-leaves))))
                  (loop new-leaves (- count (length leaves)))))))
            (for/list ([i (in-range n)] #:when (= (vector-ref in-degrees i) 0)) i))))))

(define (min-height-trees n edges)
  (find-min-height-trees n edges))