(define (pivot-table matrix r c)
  (define (reshape matrix r c)
    (if (not (= (length matrix) 0))
        (let* ((total (apply + (map length matrix)))
               (flat (apply append matrix)))
          (if (= (length flat) (* r c))
              (map (lambda (i) (sublist flat (* i c) (* (+ i 1) c))) (range r))
              '()))
        '()))
  (reshape matrix r c))