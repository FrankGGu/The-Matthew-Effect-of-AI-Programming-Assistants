(define (count-black-blocks(m n coordinates))
  (define black-blocks (make-hash))
  (for ((coord coordinates))
    (hash-set! black-blocks coord #t))
  (define directions '((-1 -1) (-1 0) (-1 1) (0 -1) (0 1) (1 -1) (1 0) (1 1)))
  (define (in-bounds? x y)
    (and (>= x 0) (< x m) (>= y 0) (< y n)))
  (define (count-blocks x y)
    (define count 0)
    (for ((dx directions))
      (define new-x (+ x (car dx)))
      (define new-y (+ y (cadr dx)))
      (when (in-bounds? new-x new-y)
        (when (hash-ref black-blocks (cons new-x new-y) #f)
          (set! count (+ count 1)))))
    count)
  (define result (make-vector 4 0))
  (for ((coord coordinates))
    (define x (car coord))
    (define y (cadr coord))
    (for ((dx (range 2)))
      (for ((dy (range 2)))
        (when (and (in-bounds? (- x dx) (- y dy))
                   (in-bounds? (- x dx 1) (- y dy 1)))
          (vector-set! result (+ (* dx 2) dy) (+ (vector-ref result (+ (* dx 2) dy)) (count-blocks (- x dx) (- y dy))))))))
  (vector->list result))

(define m 3)
(define n 3)
(define coordinates '((1 1) (1 0) (0 1)))
(count-black-blocks m n coordinates)