(define (numMovesStonesII stones)
  (define (max-moves stones)
    (let* ((sorted (sort stones <))
           (n (length sorted))
           (max-move (max (- (last sorted) (first sorted) -1)
                          (- n 1))))
      max-move))

  (define (min-moves stones)
    (let* ((sorted (sort stones <))
           (n (length sorted))
           (gaps (map - (cdr sorted) sorted))
           (count (foldl (lambda (gap acc)
                            (if (= gap 1) acc (add1 acc)))
                          0 gaps)))
      (if (= count 0)
          (if (= n 2) 0 1)
          (if (= count 1) 1 2))))

  (define max (max-moves stones))
  (define min (min-moves stones))
  (list min max))

(numMovesStonesII (vector->list (vector 7 4 9)))