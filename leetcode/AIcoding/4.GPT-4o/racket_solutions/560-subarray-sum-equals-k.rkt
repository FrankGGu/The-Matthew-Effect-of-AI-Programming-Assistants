(define (subarray-sum k nums)
  (define counts (make-hash '()))
  (hash-set! counts 0 1)
  (define (helper prefix-sum count)
    (if (null? nums)
        count
        (let* ((new-prefix-sum (+ prefix-sum (car nums)))
               (target (- new-prefix-sum k))
               (count (if (hash-has-key? counts target)
                           (+ count (hash-ref counts target))
                           count)))
          (hash-set! counts new-prefix-sum (+ (hash-ref counts new-prefix-sum 0) 1))
          (helper (cdr nums) count))))
  (helper 0 0))