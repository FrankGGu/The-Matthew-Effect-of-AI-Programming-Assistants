(define (longest-consecutive nums)
  (define (set->list s)
    (foldl (lambda (x acc) (cons x acc)) '() s))
  (define s (set (set->list (set nums))))
  (define (count-sequence n)
    (define (helper n count)
      (if (set-member? s (+ n 1))
          (helper (+ n 1) (+ count 1))
          count))
    (helper n 1))
  (define max-length 0)
  (for-each (lambda (n)
              (unless (set-member? s n)
                (begin
                  (set-delete! s n)
                  (define length (count-sequence n))
                  (set-delete! s (+ n 1))
                  (set! max-length (max max-length length)))))
            (set->list s))
  max-length)