(define (vowels-of-all-substrings word)
  (define (is-vowel? char)
    (or (char=? char #\a)
        (char=? char #\e)
        (char=? char #\i)
        (char=? char #\o)
        (char=? char #\u)))

  (define len (string-length word))
  (for/sum ([i (in-range len)])
    (let ([char (string-ref word i)])
      (if (is-vowel? char)
          (* (+ i 1) (- len i))
          0))))