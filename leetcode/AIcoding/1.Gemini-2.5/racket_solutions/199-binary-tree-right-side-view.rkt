(define (right-side-view root)
  (if (not root) '()
      (let bfs-loop ((queue (list root))
                     (result-acc '()))
        (if (null? queue)
            (reverse result-acc)
            (let process-level ((nodes-in-current-level queue)
                                (next-level-nodes-acc '())
                                (current-level-rightmost-val #f))
              (if (null? nodes-in-current-level)
                  (bfs-loop (reverse next-level-nodes-acc)
                            (cons current-level-rightmost-val result-acc))
                  (let* ((node (car nodes-in-current-level))
                         (rest-of-current-level (cdr nodes-in-current-level))
                         (left-child (TreeNode-left node))
                         (right-child (TreeNode-right node)))
                    (process-level rest-of-current-level
                                   (let ((acc (if left-child (cons left-child next-level-nodes-acc) next-level-nodes-acc)))
                                     (if right-child (cons right-child acc) acc)))
                                   (TreeNode-val node))))))))