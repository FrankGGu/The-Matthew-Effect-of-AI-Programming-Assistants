(define (intervalIntersection firstList secondList)
  (let loop ((l1 firstList)
             (l2 secondList)
             (acc '()))
    (if (or (null? l1) (null? l2))
        (reverse acc)
        (let* ((interval1 (car l1))
               (interval2 (car l2))
               (start1 (car interval1))
               (end1 (cadr interval1))
               (start2 (car interval2))
               (end2 (cadr interval2))
               (low (max start1 start2))
               (high (min end1 end2)))
          (cond
            ((<= low high)
             (if (< end1 end2)
                 (loop (cdr l1) l2 (cons (list low high) acc))
                 (loop l1 (cdr l2) (cons (list low high) acc))))
            ((< end1 end2)
             (loop (cdr l1) l2 acc))
            (else
             (loop l1 (cdr l2) acc)))))))