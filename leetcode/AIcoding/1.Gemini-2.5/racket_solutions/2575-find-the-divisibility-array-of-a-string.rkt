(define (divisibility-array word m)
  (let* ((len (string-length word))
         (result (make-vector len)))
    (let loop ((i 0) (current-remainder 0))
      (when (< i len)
        (let* ((char-digit (- (char->integer (string-ref word i)) (char->integer #\0)))
               (new-remainder (modulo (+ (* current-remainder 10) char-digit) m)))
          (vector-set! result i (if (= new-remainder 0) 1 0))
          (loop (+ i 1) new-remainder))))
    (vector->list result)))