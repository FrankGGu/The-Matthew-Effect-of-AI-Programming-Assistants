(define (minimum-flips grid)
  (let* ((R (length grid))
         (C (length (car grid))))
    (for/sum ((i (in-range 0 (add1 (floor (/ (sub1 R) 2))))))
      (for/sum ((j (in-range 0 (add1 (floor (/ (sub1 C) 2))))))
        (let* ((r-sym (- (sub1 R) i))
               (c-sym (- (sub1 C) j))
               (vals (list (list-ref (list-ref grid i) j))))
          (when (not (= r-sym i))
            (set! vals (cons (list-ref (list-ref grid r-sym) j) vals)))
          (when (not (= c-sym j))
            (set! vals (cons (list-ref (list-ref grid i) c-sym) vals)))
          (when (and (not (= r-sym i)) (not (= c-sym j)))
            (set! vals (cons (list-ref (list-ref grid r-sym) c-sym) vals)))

          (let ((count0 (count 0 vals))
                (count1 (count 1 vals)))
            (min count0 count1)))))))