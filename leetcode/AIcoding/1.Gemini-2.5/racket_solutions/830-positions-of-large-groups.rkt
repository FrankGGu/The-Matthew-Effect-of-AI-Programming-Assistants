(define (large-group-positions s)
  (let ((n (string-length s)))
    (if (zero? n)
        '()
        (let loop ((i 1)
                   (current-char (string-ref s 0))
                   (start-idx 0)
                   (current-count 1)
                   (acc '()))
          (if (= i n)
              (if (>= current-count 3)
                  (reverse (cons (list start-idx (- i 1)) acc))
                  (reverse acc))
              (let ((char-at-i (string-ref s i)))
                (if (char=? char-at-i current-char)
                    (loop (+ i 1) current-char start-idx (+ current-count 1) acc)
                    (if (>= current-count 3)
                        (loop (+ i 1) char-at-i i 1 (cons (list start-idx (- i 1)) acc))
                        (loop (+ i 1) char-at-i i 1 acc)))))))))