(define (count-pairs-of-points-with-distance-k points k)
  (let ((n (length points)))
    (for/sum ([i (range n)])
      (for/sum ([j (range (+ i 1) n)])
        (let* ((p1 (list-ref points i))
               (p2 (list-ref points j))
               (x1 (list-ref p1 0))
               (y1 (list-ref p1 1))
               (x2 (list-ref p2 0))
               (y2 (list-ref p2 1))
               (dist (+ (abs (- x1 x2)) (abs (- y1 y2)))))
          (if (= dist k) 1 0))))))