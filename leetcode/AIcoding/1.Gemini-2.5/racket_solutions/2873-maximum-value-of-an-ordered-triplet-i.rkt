(define (maximum-triplet-value nums)
  (let* ((vec (list->vector nums))
         (n (vector-length vec)))
    (if (< n 3)
        0
        (let loop-i ((i 0) (max-so-far 0))
          (if (>= i (- n 2))
              max-so-far
              (let loop-j ((j (+ i 1)))
                (if (>= j (- n 1))
                    (loop-i (+ i 1) max-so-far)
                    (let loop-k ((k (+ j 1)))
                      (if (>= k n)
                          (loop-j (+ j 1))
                          (let* ((val-i (vector-ref vec i))
                                 (val-j (vector-ref vec j))
                                 (val-k (vector-ref vec k))
                                 (current-triplet-value (* (- val-i val-j) val-k)))
                            (loop-k (+ k 1) (max max-so-far current-triplet-value))))))))))))