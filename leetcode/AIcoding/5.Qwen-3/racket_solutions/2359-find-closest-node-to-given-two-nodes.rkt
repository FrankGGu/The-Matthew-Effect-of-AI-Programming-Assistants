#lang racket

(define (closest-node-to-given-two-nodes root n start end)
  (define (bfs root start end)
    (define (helper node target)
      (let ((queue (list (cons node #f)))
            (visited (set)))
        (let loop ()
          (when (not (null? queue))
            (let* ((current (car queue))
                   (node (car current))
                   (dist (cdr current)))
              (when (equal? node target)
                (return dist))
              (set! visited (set-add visited node))
              (for-each
               (lambda (child)
                 (when (not (set-member? visited child))
                   (set! queue (append queue (list (cons child (+ dist 1)))))))
               (if (equal? node root) '() (reverse (filter (lambda (x) (equal? x node)) (map cdr (filter (lambda (x) (equal? (car x) node)) (reverse (flatten (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (flatten (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x) (if (equal? (car x) node) (cdr x) '())) (map (lambda (x