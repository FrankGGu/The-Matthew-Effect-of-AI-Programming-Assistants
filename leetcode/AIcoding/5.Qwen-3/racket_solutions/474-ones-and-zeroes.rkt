(define (find-ones-zeroes strs)
  (define (count-ones-zeroes s)
    (let ((ones 0) (zeros 0))
      (for-each (lambda (c)
                  (cond ((char=? c #\0) (set! zeros (+ zeros 1)))
                        ((char=? c #\1) (set! ones (+ ones 1)))))
                (string->list s))
      (cons ones zeros)))
  (define (dp i zeros ones)
    (if (or (> i (length strs)) (< zeros 0) (< ones 0))
        0
        (let* ((s (list-ref strs i))
               (cnt (count-ones-zeroes s))
               (o (car cnt))
               (z (cdr cnt)))
          (max (dp (+ i 1) zeros ones)
               (if (and (>= zeros z) (>= ones o))
                   (+ 1 (dp (+ i 1) (- zeros z) (- ones o)))
                   0))))
  (dp 0 (string-length (list-ref strs 0)) (string-length (list-ref strs 0))) )