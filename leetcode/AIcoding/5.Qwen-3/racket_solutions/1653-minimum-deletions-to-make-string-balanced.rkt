(define (balanced-string s)
  (define n (string-length s))
  (define cnt (make-hash))
  (for ([c (in-string s)])
    (hash-update! cnt c add1 0))
  (define res n)
  (define left 0)
  (define right (hash-ref cnt #\a) (hash-ref cnt #\b) (hash-ref cnt #\c))
  (for ([i (in-range n)])
    (when (char=? (string-ref s i) #\a)
      (set! left (add1 left))
      (set! right (sub1 right)))
    (when (char=? (string-ref s i) #\b)
      (set! left (add1 left))
      (set! right (sub1 right)))
    (when (char=? (string-ref s i) #\c)
      (set! left (add1 left))
      (set! right (sub1 right)))
    (set! res (min res (+ left (- (hash-ref cnt #\a) right) (- (hash-ref cnt #\b) right) (- (hash-ref cnt #\c) right))))
    (when (char=? (string-ref s i) #\a)
      (set! left (sub1 left))
      (set! right (add1 right)))
    (when (char=? (string-ref s i) #\b)
      (set! left (sub1 left))
      (set! right (add1 right)))
    (when (char=? (string-ref s i) #\c)
      (set! left (sub1 left))
      (set! right (add1 right))))
  res)