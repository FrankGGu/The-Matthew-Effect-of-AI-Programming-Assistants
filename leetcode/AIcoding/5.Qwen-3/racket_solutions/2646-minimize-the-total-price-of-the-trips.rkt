#lang racket

(define (min-total-price n edges price trips)
  (define graph (make-hash))
  (for ([e edges])
    (define u (car e))
    (define v (cadr e))
    (hash-update! graph u (λ (lst) (cons v lst)) '())
    (hash-update! graph v (λ (lst) (cons u lst)) '()))

  (define visited (make-hash))
  (define (dfs node parent)
    (for ([neighbor (hash-ref graph node)])
      (when (not (= neighbor parent))
        (dfs neighbor node))))

  (define (get-ancestor node k)
    (let loop ([node node] [k k])
      (if (= k 0)
          node
          (loop (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector-ref (vector