(define (count-unique-subjects teachers)
  (define (process-row row)
    (let ((teacher-id (car row))
          (subject (cadr row)))
      (cons teacher-id subject)))
  (define (combine acc key value)
    (if (assoc key acc)
        (map (lambda (x)
               (if (equal? (car x) key)
                   (cons key (append (cdr x) (list value)))
                   x))
             acc)
        (append acc (list (cons key (list value))))))
  (define (flatten-result lst)
    (map (lambda (x) (list (car x) (length (cdr x)))) lst))
  (let ((processed (map process-row teachers)))
    (flatten-result
     (foldl combine '() processed))))