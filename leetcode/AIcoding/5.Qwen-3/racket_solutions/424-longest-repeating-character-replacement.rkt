(define (character-replacement s k)
  (define (max-length)
    (let ((count (make-hash))
          (left 0)
          (max-count 0)
          (max-len 0))
      (for ([right (in-range (string-length s))])
        (hash-set! count (string-ref s right) (+ 1 (hash-ref count (string-ref s right) 0)))
        (set! max-count (max max-count (hash-ref count (string-ref s right))))
        (when (> (- right left) (+ k max-count))
          (hash-set! count (string-ref s left) (- (hash-ref count (string-ref s left)) 1))
          (set! left (+ left 1)))
        (set! max-len (max max-len (- right left))))
      max-len))
  (if (or (null? s) (= (string-length s) 0)) 0 (max-length)))