(define (maximum-score nums)
  (define n (length nums))
  (define left (make-vector n 0))
  (define right (make-vector n 0))
  (define stack (list))
  (for ([i (in-range n)])
    (set! stack (cons i stack)))
  (for ([i (in-range n)])
    (let loop ()
      (when (and (not (null? stack)) (< (vector-ref nums (car stack)) (vector-ref nums i)))
        (vector-set! right (car stack) i)
        (set! stack (cdr stack))
        (loop))))
  (set! stack (list))
  (for ([i (in-range n -1 -1)])
    (let loop ()
      (when (and (not (null? stack)) (< (vector-ref nums (car stack)) (vector-ref nums i)))
        (vector-set! left (car stack) i)
        (set! stack (cdr stack))
        (loop))))
  (let loop ([i 0] [max-score 0])
    (if (= i n)
        max-score
        (loop (+ i 1) (max max-score (* (vector-ref nums i) (- (vector-ref right i) (vector-ref left i) 1)))))))