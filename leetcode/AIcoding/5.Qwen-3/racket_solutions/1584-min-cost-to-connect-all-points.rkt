(define (min-cost-to-connect-all-points points)
  (define n (length points))
  (define (distance i j)
    (+ (abs (- (list-ref (list-ref points i) 0) (list-ref (list-ref points j) 0)))
       (abs (- (list-ref (list-ref points i) 1) (list-ref (list-ref points j) 1)))))
  (define (prim)
    (define visited (make-vector n #f))
    (define (get-min-edge)
      (let loop ([i 0] [min-dist +inf.0] [min-index -1])
        (if (= i n)
            (if (= min-index -1) #f (cons min-index min-dist))
            (if (vector-ref visited i)
                (loop (+ i 1) min-dist min-index)
                (loop (+ i 1) (min min-dist (distance i (vector-ref visited 0))) i)))))
    (vector-set! visited 0 #t)
    (let loop ([total 0] [edges 0])
      (if (= edges (- n 1))
          total
          (let* ([edge (get-min-edge)]
                 [u (car edge)]
                 [d (cdr edge)])
            (vector-set! visited u #t)
            (loop (+ total d) (+ edges 1))))))
  (prim))