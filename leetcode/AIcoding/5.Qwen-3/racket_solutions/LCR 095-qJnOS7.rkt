(define (longest-common-subsequence text1 text2)
  (define n (string-length text1))
  (define m (string-length text2))
  (define dp (make-vector (add1 n) #f))
  (for ([i (in-range (add1 n))])
    (vector-set! dp i (make-vector (add1 m) 0)))
  (for ([i (in-range 1 (add1 n))])
    (for ([j (in-range 1 (add1 m))])
      (if (char=? (string-ref text1 (sub1 i)) (string-ref text2 (sub1 j)))
          (vector-set! (vector-ref dp i) j (+ (vector-ref (vector-ref dp (sub1 i)) (sub1 j)) 1))
          (vector-set! (vector-ref dp i) j (max (vector-ref (vector-ref dp (sub1 i)) j) (vector-ref (vector-ref dp i) (sub1 j)))))))
  (vector-ref (vector-ref dp n) m))