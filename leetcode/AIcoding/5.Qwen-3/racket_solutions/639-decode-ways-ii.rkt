(define (num-decode-ways s)
  (define mod 1000000007)
  (define len (string-length s))
  (define dp (make-vector (+ len 1) 0))
  (vector-set! dp 0 1)
  (when (> len 0)
    (vector-set! dp 1 (if (= (string-ref s 0) #\*) 9 1)))
  (for ([i (in-range 2 (+ len 1))])
    (let ([current (string-ref s (- i 1))]
          [prev (string-ref s (- i 2))])
      (when (and (char=? current #\*) (char=? prev #\*))
        (vector-set! dp i (* (vector-ref dp (- i 1)) 9)))
      (when (and (char=? current #\*) (not (char=? prev #\*)))
        (vector-set! dp i (* (vector-ref dp (- i 1)) 9)))
      (when (and (not (char=? current #\*)) (char=? prev #\*))
        (vector-set! dp i (* (vector-ref dp (- i 1)) 9)))
      (when (and (not (char=? current #\*)) (not (char=? prev #\*)))
        (when (<= (string->number (substring s (- i 2) (- i 1))) 26)
          (vector-set! dp i (modulo (+ (vector-ref dp i) (vector-ref dp (- i 2))) mod))))
      (when (char=? current #\*)
        (vector-set! dp i (modulo (+ (vector-ref dp i) (vector-ref dp (- i 1))) mod)))
      (when (and (char=? prev #\*) (not (char=? current #\*)))
        (when (<= (string->number (substring s (- i 2) (- i 1))) 26)
          (vector-set! dp i (modulo (+ (vector-ref dp i) (vector-ref dp (- i 2))) mod))))
      (when (and (not (char=? prev #\*)) (not (char=? current #\*)))
        (when (<= (string->number (substring s (- i 2) (- i 1))) 26)
          (vector-set! dp i (modulo (+ (vector-ref dp i) (vector-ref dp (- i 2))) mod))))
      (when (and (char=? prev #\*) (char=? current #\*))
        (vector-set! dp i (modulo (+ (vector-ref dp i) (* (vector-ref dp (- i 1)) 9)) mod)))))
  (vector-ref dp len))

(define (decode-ways s)
  (num-decode-ways s))