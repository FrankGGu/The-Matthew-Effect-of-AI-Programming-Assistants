(define (merge-intervals intervals)
  (if (null? intervals)
      '()
      (let* ((sorted (sort intervals (lambda (a b) (< (car a) (car b)))))
             (result (list (car sorted))))
        (for-each
         (lambda (interval)
           (let* ((last (car result))
                  (last-end (cadr last)))
             (if (<= (cadr interval) last-end)
                 (set-car! result (list (car last) (max (cadr interval) last-end)))
                 (set! result (cons interval result)))))
         (cdr sorted))
        (reverse result))))