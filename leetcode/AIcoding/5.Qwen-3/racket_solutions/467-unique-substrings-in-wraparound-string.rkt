(define (find-substring-in-wraparound-string p)
  (define dp (make-vector 26 0))
  (define len 0)
  (for ([i (in-range (string-length p))])
    (when (and (> i 0) (char=? (char-downcase (string-ref p i)) (char-downcase (string-ref p (sub1 i))) 1))
      (set! len (add1 len))
      (vector-set! dp (- (char->integer (char-downcase (string-ref p i))) (char->integer #\a)) len))
    (when (and (< i 1) (vector-ref dp (- (char->integer (char-downcase (string-ref p i))) (char->integer #\a))) 0)
      (vector-set! dp (- (char->integer (char-downcase (string-ref p i))) (char->integer #\a)) 1)))
  (apply + (vector->list dp)))