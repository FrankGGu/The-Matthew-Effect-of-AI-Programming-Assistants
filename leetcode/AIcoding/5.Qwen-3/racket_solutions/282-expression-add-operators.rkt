#lang racket

(define (add-operators num target)
  (define result '())
  (define (dfs start path value last)
    (when (= start (string-length num))
      (when (= value target)
        (set! result (cons (substring path 1) result)))
      (return))
    (for ([i (in-range start (string-length num))])
      (when (and (not (zero? start)) (char=? #\0 (string-ref num start)))
        (return))
      (define current (string->number (substring num start (add1 i))))
      (when (zero? start)
        (dfs (add1 i) (format "~a~a" path current) current current))
      (dfs (add1 i) (format "~a+~a" path current) (+ value current) current)
      (dfs (add1 i) (format "~a-~a" path current) (- value current) (- current))
      (dfs (add1 i) (format "~a*~a" path current) (- value last) (* last current))))
  (dfs 0 "" 0 0)
  result)