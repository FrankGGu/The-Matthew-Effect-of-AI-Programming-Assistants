(define (zigzag-level-order root)
  (define (traverse queue result)
    (if (null? queue)
        result
        (let* ((level-size (length queue))
               (current-level '())
               (next-queue '()))
          (for ([i (in-range level-size)])
            (let* ((node (car queue))
                   (val (if node (node-val node) #f))
                   (left (if node (node-left node) #f))
                   (right (if node (node-right node) #f)))
              (set! current-level (append current-level (list val)))
              (when left (set! next-queue (append next-queue (list left))))
              (when right (set! next-queue (append next-queue (list right))))
              (set! queue (cdr queue))))
          (if (odd? (length result))
              (traverse next-queue (append result (list (reverse current-level))))
              (traverse next-queue (append result (list current-level)))))))
  (if (null? root)
      '()
      (traverse (list root) '())))