(define (sum-of-subarray-ranges nums)
  (define n (length nums))
  (define result 0)
  (for ([i (in-range n)])
    (define min-val (list-ref nums i))
    (define max-val (list-ref nums i))
    (for ([j (in-range i n)])
      (set! min-val (min min-val (list-ref nums j)))
      (set! max-val (max max-val (list-ref nums j)))
      (set! result (+ result (- max-val min-val)))))
  result)