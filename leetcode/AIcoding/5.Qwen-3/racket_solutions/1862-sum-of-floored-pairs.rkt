#lang racket

(define (sum-of-floored-pairs nums)
  (define max-num (apply max nums))
  (define freq (make-hash))
  (for ([n nums])
    (hash-update! freq n add1 0))
  (define res 0)
  (for ([a (in-hash-keys freq)])
    (for ([b (in-range 1 (add1 (quotient max-num a)))])
      (define lower (* a b))
      (define upper (* a (add1 b)))
      (when (hash-has-key? freq lower)
        (set! res (+ res (* (hash-ref freq a) (hash-ref freq lower))))))
    (when (hash-has-key? freq a)
      (set! res (+ res (* (hash-ref freq a) (hash-ref freq a)))))
    (when (and (>= a 1) (hash-has-key? freq (* a 2)))
      (set! res (+ res (* (hash-ref freq a) (hash-ref freq (* a 2)))))))
  res)