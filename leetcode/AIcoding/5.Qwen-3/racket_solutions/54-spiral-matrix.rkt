(define (spiral-order matrix)
  (if (null? matrix)
      '()
      (let loop ((matrix matrix) (result '()))
        (if (null? matrix)
            result
            (let ((top (car matrix))
                  (bottom (last matrix))
                  (left (map car matrix))
                  (right (map (lambda (row) (last row)) matrix)))
              (if (equal? top bottom)
                  (append result top)
                  (if (= (length top) 1)
                      (append result (map car matrix))
                      (append result (append top (cdr right) (reverse (cdr bottom)) (reverse (cdr left))))))))
        (let* ((new-matrix (map (lambda (row) (cdr (reverse (cdr (reverse row))))) (cdr (reverse (cdr matrix)))))
          (loop new-matrix result))))))