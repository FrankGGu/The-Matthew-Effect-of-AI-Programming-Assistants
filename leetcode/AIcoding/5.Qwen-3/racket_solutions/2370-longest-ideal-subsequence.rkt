(define (longest-ideal-subsequence s)
  (define (char->index c)
    (- (char->integer c) (char->integer #\a)))
  (define dp (make-vector 26 0))
  (for-each
   (lambda (c)
     (let ((i (char->index c)))
       (vector-set! dp i (+ (vector-ref dp i) 1))
       (when (> i 0)
         (vector-set! dp i (max (vector-ref dp i) (vector-ref dp (- i 1)))))
       (when (< i 25)
         (vector-set! dp i (max (vector-ref dp i) (vector-ref dp (+ i 1)))))))
   (string->list s))
  (apply max (vector->list dp)))