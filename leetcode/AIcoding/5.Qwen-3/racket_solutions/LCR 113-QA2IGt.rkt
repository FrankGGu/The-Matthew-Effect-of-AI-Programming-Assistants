#lang racket

(define (find-order num-courses prerequisites)
  (define graph (make-hash))
  (define in-degree (make-hash))
  (for ([i (in-range num-courses)])
    (hash-set! graph i '())
    (hash-set! in-degree i 0))
  (for ([prereq (in-list prerequisites)])
    (define course (second prereq))
    (define pre (first prereq))
    (hash-set! graph course (cons pre (hash-ref graph course)))
    (hash-set! in-degree pre (+ 1 (hash-ref in-degree pre))))
  (define queue (queue))
  (for ([i (in-range num-courses)])
    (when (= (hash-ref in-degree i) 0)
      (enqueue! queue i)))
  (define result '())
  (let loop ()
    (when (not (queue-empty? queue))
      (define course (dequeue! queue))
      (set! result (cons course result))
      (for ([neighbor (hash-ref graph course)])
        (hash-set! in-degree neighbor (- (hash-ref in-degree neighbor) 1))
        (when (= (hash-ref in-degree neighbor) 0)
          (enqueue! queue neighbor)))
      (loop)))
  (if (= (length result) num-courses)
      (reverse result)
      '()))