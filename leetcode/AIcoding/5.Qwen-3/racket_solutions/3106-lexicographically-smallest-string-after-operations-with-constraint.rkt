(define (lexicographically-smallest-string s k)
  (define (swap i j)
    (let ((c (vector-ref s i)))
      (vector-set! s i (vector-ref s j))
      (vector-set! s j c)))
  (define (min-lex)
    (list->string (vector->list s)))
  (define (dfs pos)
    (if (>= pos (string-length s))
        (min-lex)
        (let ((res (min-lex)))
          (when (<= (- (string-length s) pos) k)
            (let ((new-k (- k (- (string-length s) pos))))
              (for-each
               (lambda (i)
                 (when (<= i (- (string-length s) 1))
                   (swap pos i)
                   (set! res (min res (dfs (+ pos 1))))
                   (swap pos i)))
               (range pos (string-length s)))))
          res)))
  (dfs 0))