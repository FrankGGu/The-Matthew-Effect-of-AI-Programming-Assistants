var minMalwareSpread = function(graph, initial) {
    const n = graph.length;
    const initialSet = new Set(initial);
    let minInfected = Infinity;
    let res = -1;

    for (let node of initial) {
        let infected = 0;
        const visited = new Array(n).fill(false);
        const q = [];

        const currentInitial = initial.filter(x => x !== node);
        const currentInitialSet = new Set(currentInitial);

        for (let initNode of currentInitial) {
            if(!visited[initNode]){
                q.push(initNode);
                visited[initNode] = true;
            }
        }

        while (q.length > 0) {
            const curr = q.shift();
            infected++;

            for (let neighbor = 0; neighbor < n; neighbor++) {
                if (graph[curr][neighbor] === 1 && !visited[neighbor] && !currentInitialSet.has(neighbor)) {
                    q.push(neighbor);
                    visited[neighbor] = true;
                }
            }
        }

        if (infected < minInfected) {
            minInfected = infected;
            res = node;
        } else if (infected === minInfected) {
            res = Math.min(res, node);
        }
    }

    return res;
};