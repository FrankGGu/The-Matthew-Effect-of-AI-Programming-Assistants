(define (min-interval intervals queries)
  (define n (length queries))
  (define sorted-queries (list->vector (sort (build-list n (λ (i) (list (list-ref queries i) i))) < #:key car)))
  (define sorted-intervals (sort intervals < #:key car))
  (define result (make-vector n #f))
  (define min-heap (make-heap (λ (a b) (< (car a) (car b)))))
  (define i 0)
  (for ([query sorted-queries])
    (define q (car query))
    (define index (cadr query))
    (begin
      (while (and (< i (length sorted-intervals)) (<= (caar sorted-intervals i) q))
        (heap-add! min-heap (list (- (cadr (list-ref sorted-intervals i)) (caar (list-ref sorted-intervals i)) -1) (list-ref sorted-intervals i)))
        (set! i (+ i 1)))
      (while (and (not (heap-empty? min-heap)) (> (cadr (caaadr (heap-peek min-heap))) q))
        (heap-remove-min! min-heap))
      (if (heap-empty? min-heap)
          (vector-set! result index -1)
          (vector-set! result index (+ 1 (car (car (heap-peek min-heap)))))))))
  (vector->list result))