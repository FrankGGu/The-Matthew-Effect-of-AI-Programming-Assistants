(define (find-circle-num is-connected)
  (let* ((n (vector-length is-connected))
         (visited (make-vector n #f))
         (count 0))
    (define (dfs i)
      (vector-set! visited i #t)
      (for/list ((j (in-range n)))
        (when (and (vector-ref (vector-ref is-connected i) j)
                   (not (vector-ref visited j)))
          (dfs j)))))
    (for/list ((i (in-range n)))
      (when (not (vector-ref visited i))
        (set! count (+ count 1))
        (dfs i)))
    count))