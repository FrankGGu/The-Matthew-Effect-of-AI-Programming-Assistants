(define (sum-subseq-widths nums)
  (define MOD 1000000007)
  (define sorted-nums (sort nums <))
  (define n (length sorted-nums))
  (define powers (make-vector n 1))
  (for ([i (in-range 1 n)])
    (vector-set! powers i (modulo (* (vector-ref powers (- i 1)) 2) MOD)))
  (define sum 0)
  (for ([i (in-range n)])
    (set! sum (modulo (+ sum (* (vector-ref powers i) (vector-ref sorted-nums i))) MOD))
    (set! sum (modulo (- sum (* (vector-ref powers (- n i - 1)) (vector-ref sorted-nums i))) MOD)))
  (if (< sum 0)
      (+ sum MOD)
      sum))