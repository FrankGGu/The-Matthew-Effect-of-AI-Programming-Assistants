(define (projection-area grid)
  (let* ((rows (length grid))
         (cols (length (first grid)))
         (xy-area 0)
         (xz-area (make-vector cols 0))
         (yz-area (make-vector rows 0)))
    (for* ((i (in-range rows))
           (j (in-range cols)))
      (let ((height (list-ref (list-ref grid i) j)))
        (if (> height 0)
            (set! xy-area (+ xy-area 1)))
        (if (> height (vector-ref xz-area j))
            (vector-set! xz-area j height))
        (if (> height (vector-ref yz-area i))
            (vector-set! yz-area i height))))
    (+ xy-area
       (apply + (vector->list xz-area))
       (apply + (vector->list yz-area)))))