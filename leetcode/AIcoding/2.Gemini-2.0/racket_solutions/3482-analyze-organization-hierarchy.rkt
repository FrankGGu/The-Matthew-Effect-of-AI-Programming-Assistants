(define (analyze-org-hierarchy headID employee)
  (letrec ((children (make-hash))
           (max-depth (box 0))
           (populate-children (lambda (emps)
                                (for-each (lambda (emp)
                                            (let ((id (car emp))
                                                  (manager-id (cadr emp)))
                                              (hash-update! children manager-id (lambda (val) (cons id val)) '())
                                              ))
                                          emps)))
    (populate-children employee)
    (letrec ((dfs (lambda (node depth)
                     (set-box! max-depth (max (unbox max-depth) depth))
                     (cond
                       ((not (hash-has-key? children node))
                        depth)
                       (else
                        (let ((child-list (hash-ref children node)))
                          (apply max (map (lambda (child) (dfs child (+ depth 1))) child-list))))))))
      (dfs headID 1)
      (unbox max-depth))))