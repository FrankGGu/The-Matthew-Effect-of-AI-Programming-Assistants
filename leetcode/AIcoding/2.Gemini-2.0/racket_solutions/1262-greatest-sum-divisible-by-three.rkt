(define (max-sum-divisible-by-three nums)
  (define remainders (make-vector 3 0))
  (vector-set! remainders 0 0)
  (for ([num nums])
    (define new-remainders (make-vector 3 0))
    (for ([i (in-range 3)])
      (vector-set! new-remainders i (vector-ref remainders i)))
    (for ([i (in-range 3)])
      (define new-rem (modulo (+ (vector-ref remainders i) num) 3))
      (vector-set! new-remainders new-rem (max (vector-ref new-remainders new-rem) (+ (vector-ref remainders i) num))))
    (for ([i (in-range 3)])
      (vector-set! remainders i (vector-ref new-remainders i))))
  (vector-ref remainders 0))