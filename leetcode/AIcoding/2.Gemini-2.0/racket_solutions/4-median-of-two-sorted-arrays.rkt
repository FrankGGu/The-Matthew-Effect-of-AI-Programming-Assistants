(define (find-median-sorted-arrays nums1 nums2)
  (define m (vector-length nums1))
  (define n (vector-length nums2))
  (if (> m n)
      (find-median-sorted-arrays nums2 nums1)
      (let loop ((low 0) (high m))
        (let* ((partitionX (floor (+ low high) 2))
               (partitionY (floor (+ (+ m n 1) -partitionX) 2))
               (maxLeftX (if (= partitionX 0) -inf.0 (vector-ref nums1 (- partitionX 1))))
               (minRightX (if (= partitionX m) inf.0 (vector-ref nums1 partitionX)))
               (maxLeftY (if (= partitionY 0) -inf.0 (vector-ref nums2 (- partitionY 1))))
               (minRightY (if (= partitionY n) inf.0 (vector-ref nums2 partitionY))))
          (cond
            ((and (<= maxLeftX minRightY) (<= maxLeftY minRightX))
             (if (even? (+ m n))
                 (/ (+ (max maxLeftX maxLeftY) (min minRightX minRightY)) 2.0)
                 (max maxLeftX maxLeftY)))
            ((> maxLeftX minRightY)
             (loop low (- partitionX 1)))
            (else
             (loop (+ partitionX 1) high)))))))