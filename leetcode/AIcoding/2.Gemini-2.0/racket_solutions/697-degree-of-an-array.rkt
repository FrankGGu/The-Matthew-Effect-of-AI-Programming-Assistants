(define (find-shortest-subarray nums)
  (let* ((counts (make-hash))
         (first-seen (make-hash))
         (last-seen (make-hash))
         (degree 0)
         (min-len (length nums)))
    (for/list ((i (in-range (length nums)))
               (num (in-list nums)))
      (hash-update! counts num add1 0)
      (unless (hash-has-key? first-seen num)
        (hash-set! first-seen num i))
      (hash-set! last-seen num i)
      (set! degree (max degree (hash-ref counts num))))
    (for/list ((num (in-list nums)))
      (when (= (hash-ref counts num) degree)
        (set! min-len (min min-len (- (+ 1 (hash-ref last-seen num)) (hash-ref first-seen num))))))
    min-len))