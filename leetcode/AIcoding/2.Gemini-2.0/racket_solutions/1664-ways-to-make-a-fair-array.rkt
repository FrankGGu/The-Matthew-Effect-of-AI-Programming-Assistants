(define (ways-to-make-fair arr)
  (let* ((n (length arr))
         (even-sum (make-vector n 0))
         (odd-sum (make-vector n 0)))
    (let loop ((i 0)
               (even-acc 0)
               (odd-acc 0))
      (if (= i n)
          (let loop2 ((j 0)
                      (count 0))
            (if (= j n)
                count
                (let* ((new-even-sum (if (= 0 j) 0 (vector-ref even-sum (- j 1))))
                       (new-odd-sum (if (= 0 j) 0 (vector-ref odd-sum (- j 1))))
                       (even-remaining (- (vector-ref even-sum (- n 1)) new-even-sum (if (even? j) (vector-ref arr j) 0)))
                       (odd-remaining (- (vector-ref odd-sum (- n 1)) new-odd-sum (if (odd? j) (vector-ref arr j) 0))))
                  (loop2 (+ j 1) (+ count (if (= (+ new-even-sum odd-remaining) (+ new-odd-sum even-remaining)) 1) )))))
          (loop (+ i 1)
                (+ even-acc (if (even? i) (vector-ref arr i) 0))
                (+ odd-acc (if (odd? i) (vector-ref arr i) 0))
                (begin
                  (vector-set! even-sum i even-acc)
                  (vector-set! odd-sum i odd-acc)
                  ))))))