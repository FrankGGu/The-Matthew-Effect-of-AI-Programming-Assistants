(define (find-anagrams s p)
  (define s-len (string-length s))
  (define p-len (string-length p))
  (if (< s-len p-len)
      '()
      (let* ((p-freq (make-vector 26 0))
             (s-freq (make-vector 26 0))
             (result '()))
        (define (char-to-index c)
          (- (char->integer c) (char->integer #\a)))
        (for ((i (in-range p-len)))
          (vector-set! p-freq (char-to-index (string-ref p i)) (+ (vector-ref p-freq (char-to-index (string-ref p i))) 1))
          (vector-set! s-freq (char-to-index (string-ref s i)) (+ (vector-ref s-freq (char-to-index (string-ref s i))) 1)))
        (define (vectors-equal? v1 v2)
          (for/and ((i (in-range (vector-length v1))))
            (= (vector-ref v1 i) (vector-ref v2 i))))
        (when (vectors-equal? s-freq p-freq)
          (set! result (cons 0 result)))
        (for ((i (in-range 1 (- s-len p-len -1))))
          (let ((remove-char (string-ref s (- i 1)))
                (add-char (string-ref s (+ i p-len -1))))
            (vector-set! s-freq (char-to-index remove-char) (- (vector-ref s-freq (char-to-index remove-char)) 1))
            (vector-set! s-freq (char-to-index add-char) (+ (vector-ref s-freq (char-to-index add-char)) 1))
            (when (vectors-equal? s-freq p-freq)
              (set! result (cons i result)))))
        (reverse result))))