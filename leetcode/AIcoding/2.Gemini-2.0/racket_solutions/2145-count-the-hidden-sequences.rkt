(define (number-of-arithmetic-sequences nums diff)
  (let* ((n (length nums))
         (min-val (apply min nums))
         (max-val (apply max nums))
         (range (+ 1 (- max-val min-val)))
         (dp (make-vector range 0)))
    (for* ((i (range n))
           (j (range 0 i)))
      (let* ((diff1 (- (list-ref nums i) (list-ref nums j)))
             (val1 (list-ref nums i))
             (val2 (list-ref nums j)))
        (when (= diff1 diff)
          (vector-set! dp (+ val1 (- min-val)) (+ (vector-ref dp (+ val1 (- min-val))) 1)))))
    (apply + (vector->list dp))))

(define (count-hidden-sequences n limits nums)
  (let* ((diffs (map - (cdr nums) (car nums)))
         (sum (apply + diffs))
         (min-sum (min 0 sum))
         (max-sum (max 0 sum))
         (lower-bound (+ (car limits) (- min-sum)))
         (upper-bound (+ (cadr limits) (- max-sum)))
         (count (- upper-bound lower-bound -1)))
    (if (>= count n)
        (- count n -1)
        0)))