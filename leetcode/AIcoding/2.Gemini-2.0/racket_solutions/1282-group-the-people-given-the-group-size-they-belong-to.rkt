(define (group-the-people group-sizes)
  (let* ((n (length group-sizes))
         (groups (make-hash)))
    (for/list ([i (in-range n)])
      (let ((size (list-ref group-sizes i)))
        (hash-update! groups size (lambda (lst) (cons i lst)) null))
    )
    (let loop ([groups groups] [result '()])
      (if (hash-empty? groups)
          result
          (let* ((first-key (hash-first-key groups))
                 (lst (hash-ref groups first-key))
                 (group (take lst first-key))
                 (remaining (drop lst first-key)))
            (loop
             (if (null? remaining)
                 (hash-remove groups first-key)
                 (hash-update groups first-key (lambda (_) remaining)))
             (cons group result)))))))