(define (make-NumArray nums)
  (let* ((n (vector-length nums))
         (tree (make-vector (+ n 1) 0))
         (arr (vector->list nums)))
    (define (lowbit x)
      (- x (bitwise-and x (- x))))
    (define (update i delta)
      (let loop ((i (+ i 1)))
        (when (<= i n)
          (vector-set! tree i (+ (vector-ref tree i) delta))
          (loop (+ i (lowbit i))))))
    (define (query i)
      (let loop ((i (+ i 1)) (sum 0))
        (if (> i 0)
            (loop (- i (lowbit i)) (+ sum (vector-ref tree i)))
            sum)))
    (for/list ((i (in-range n)))
      (update i (list-ref arr i)))
    (define (update-val i val)
      (let ((old-val (list-ref arr i)))
        (set! arr (list-set arr i val))
        (update i (- val old-val))))
    (define (sum-range i j)
      (- (query j) (query (- i 1))))
    (struct NumArray (update sum-range))
    (NumArray update-val sum-range)))