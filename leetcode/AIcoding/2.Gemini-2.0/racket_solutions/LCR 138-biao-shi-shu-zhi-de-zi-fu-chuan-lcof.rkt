(define (is-digit? c)
  (and (char>=? c #\0) (char<=? c #\9)))

(define (is-valid-number s)
  (define n (string-length s))
  (define (helper i seen-digit seen-e seen-dot)
    (cond
      ((= i n) (and seen-digit (not seen-e)))
      ((char=? (string-ref s i) #\+)
       (if (or (= i 0) (and (> i 0) (or (char=? (string-ref s (- i 1)) #\e) (char=? (string-ref s (- i 1)) #\E))))
           (helper (+ i 1) seen-digit seen-e seen-dot)
           #f))
      ((char=? (string-ref s i) #\-)
       (if (or (= i 0) (and (> i 0) (or (char=? (string-ref s (- i 1)) #\e) (char=? (string-ref s (- i 1)) #\E))))
           (helper (+ i 1) seen-digit seen-e seen-dot)
           #f))
      ((is-digit? (string-ref s i))
       (helper (+ i 1) #t seen-e seen-dot))
      ((char=? (string-ref s i) #\.)
       (if (and (not seen-e) (not seen-dot))
           (helper (+ i 1) seen-digit seen-e #t)
           #f))
      ((or (char=? (string-ref s i) #\e) (char=? (string-ref s i) #\E))
       (if (and (not seen-e) seen-digit)
           (helper (+ i 1) #f #t seen-dot)
           #f))
      (else #f)))
  (helper 0 #f #f #f))