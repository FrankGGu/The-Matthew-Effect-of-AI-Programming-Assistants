(define (least-interval tasks n)
  (let* ((counts (make-vector 26 0))
         (task-count (length tasks)))
    (for ([task tasks])
      (vector-set! counts (- (char->integer task) (char->integer #\A))
                   (+ 1 (vector-ref counts (- (char->integer task) (char->integer #\A))))))
    (sort! counts >)
    (let* ((max-count (vector-ref counts 0))
           (idle-slots (* (- max-count 1) n))
           (available-tasks (- task-count max-count))
           (idle-slots-needed (max 0 (- idle-slots available-tasks))))
      (+ task-count idle-slots-needed))))