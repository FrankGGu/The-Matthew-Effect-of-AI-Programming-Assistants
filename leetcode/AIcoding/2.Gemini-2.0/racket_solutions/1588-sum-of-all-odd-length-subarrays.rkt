(define (sum-odd-length-subarrays arr)
  (let* ((n (length arr))
         (total-sum 0))
    (for* ((i (in-range n))
           (len (in-range 1 (+ n 1) 2))
           #:when (<= (+ i len -1) (- n 1)))
      (let ((sub-array (subvector arr i len)))
        (set! total-sum (+ total-sum (apply + (vector->list sub-array))))))
    total-sum))