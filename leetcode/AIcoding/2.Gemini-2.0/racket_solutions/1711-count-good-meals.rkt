(define (count-good-meals list)
  (define n (length list))
  (define meal-counts (make-hash))
  (for ([meal list])
    (hash-update! meal-counts meal (lambda (v) (+ v 1)) 1))
  (define ans 0)
  (for ([meal list])
    (define target-powers (list 2 4 8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768 65536 131072 262144))
    (for ([power target-powers])
      (define complement (- power meal))
      (when (hash-has-key? meal-counts complement)
        (if (= meal complement)
            (set! ans (+ ans (quotient (- (hash-ref meal-counts complement) 1) 1)))
            (set! ans (+ ans (hash-ref meal-counts complement)))))))
  (define result (quotient ans 2))
  (modulo result 1000000007))