(define (merge intervals)
  (if (null? intervals)
      '()
      (let* ((sorted-intervals (sort intervals < #:key car))
             (result (list (car sorted-intervals))))
        (for-each (lambda (interval)
                    (let ((last-merged (car result)))
                      (if (>= (car interval) (cadr last-merged))
                          (set! result (cons interval result))
                          (if (>= (cadr interval) (cadr last-merged))
                              (set! result (cons (list (car last-merged) (cadr interval)) (cdr result)))
                              (void)))))
                  (cdr sorted-intervals))
        (reverse result))))