(define (min-malware-spread graph initial)
  (define n (vector-length graph))
  (define parent (make-vector n 0))
  (define size (make-vector n 1))

  (define (find x)
    (if (= (vector-ref parent x) 0)
        x
        (let ((root (find (vector-ref parent x))))
          (vector-set! parent x root)
          root)))

  (define (union x y)
    (let* ((rootX (find x))
           (rootY (find y)))
      (if (= rootX rootY)
          #f
          (begin
            (if (< (vector-ref size rootX) (vector-ref size rootY))
                (begin
                  (vector-set! parent rootX rootY)
                  (vector-set! size rootY (+ (vector-ref size rootY) (vector-ref size rootX))))
                (begin
                  (vector-set! parent rootY rootX)
                  (vector-set! size rootX (+ (vector-ref size rootX) (vector-ref size rootY)))))
            #t))))

  (for* ((i (in-range n))
         (j (in-range n)))
    (when (and (= (vector-ref (vector-ref graph i) j) 1)
               (!= i j))
      (union i j)))

  (define count (make-vector n 0))
  (for ((node (in-list initial)))
    (vector-set! count (find node) (+ (vector-ref count (find node)) 1)))

  (define ans -1)
  (define ans-size -1)
  (for ((node (in-list initial)))
    (let ((root (find node)))
      (when (= (vector-ref count root) 1)
        (let ((size-root (vector-ref size root)))
          (if (> size-root ans-size)
              (begin
                (set! ans node)
                (set! ans-size size-root))
              (when (= size-root ans-size)
                (set! ans (min ans node))))))))

  (if (= ans -1)
      (apply min initial)
      ans))