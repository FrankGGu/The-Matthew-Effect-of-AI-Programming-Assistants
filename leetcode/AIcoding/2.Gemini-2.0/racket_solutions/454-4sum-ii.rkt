(define (four-sum-count A B C D)
  (let* ((n (length A))
         (sum-map (make-hash)))
    (for* ((i (in-range n))
           (j (in-range n)))
      (let ((sum (+ (list-ref A i) (list-ref B j))))
        (hash-update! sum-map sum (Î» (v) (+ v 1)) 1)))
    (let ((count 0))
      (for* ((i (in-range n))
             (j (in-range n)))
        (let ((sum (- 0 (+ (list-ref C i) (list-ref D j)))))
          (when (hash-has-key? sum-map sum)
            (set! count (+ count (hash-ref sum-map sum))))))
      count)))