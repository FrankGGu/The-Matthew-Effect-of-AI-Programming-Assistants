(define (find-order num-courses prerequisites)
  (let* ((in-degree (make-vector num-courses 0))
         (adj (make-vector num-courses '()))
         (result '()))
    (for ([p prerequisites])
      (let ((course (car p))
            (pre (cdr p)))
        (vector-set! in-degree course (+ (vector-ref in-degree course) 1))
        (vector-set! adj pre (cons course (vector-ref adj pre)))))
    (let loop ([queue (filter (lambda (i) (= (vector-ref in-degree i) 0)) (range num-courses))])
      (if (null? queue)
          (if (= (length result) num-courses)
              (reverse result)
              '())
          (let ((course (car queue)))
            (set! result (cons course result))
            (let ((neighbors (vector-ref adj course)))
              (for ([neighbor neighbors])
                (vector-set! in-degree neighbor (- (vector-ref in-degree neighbor) 1)))
              (loop (append (cdr queue) (filter (lambda (i) (= (vector-ref in-degree i) 0)) (range num-courses)))))))))