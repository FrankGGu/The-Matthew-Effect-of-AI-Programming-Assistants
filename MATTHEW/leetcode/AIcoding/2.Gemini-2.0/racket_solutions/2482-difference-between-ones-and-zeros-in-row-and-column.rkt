(define (ones-minus-zeros matrix)
  (let* ((m (length matrix))
         (n (length (car matrix)))
         (row-ones (make-vector m 0))
         (col-ones (make-vector n 0)))
    (for* ((i (in-range m))
           (j (in-range n)))
      (if (= (list-ref (list-ref matrix i) j) 1)
          (begin
            (vector-set! row-ones i (+ (vector-ref row-ones i) 1))
            (vector-set! col-ones j (+ (vector-ref col-ones j) 1)))))
    (let ((diff (make-vector m (make-vector n 0))))
      (for* ((i (in-range m))
             (j (in-range n)))
        (vector-set! (vector-ref diff i) j (+ (- (vector-ref row-ones i) (- m (vector-ref row-ones i)))
                                                (- (vector-ref col-ones j) (- n (vector-ref col-ones j))))))
      (vector->list (map vector->list (vector->list diff))))))