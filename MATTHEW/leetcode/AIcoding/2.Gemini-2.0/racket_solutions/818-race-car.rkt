(define (racecar target)
  (let ((q (list (list 0 1 0)))
        (visited (make-hash)))
    (hash-set! visited (list 0 1) #t)
    (let loop ((q q))
      (if (null? q)
          #f
          (let* ((curr (car q))
                 (pos (car curr))
                 (speed (cadr curr))
                 (steps (caddr curr)))
            (if (= pos target)
                steps
                (let ((next-a (list (+ pos speed) (* 2 speed) (+ steps 1)))
                      (next-r (list pos (- (if (> 0 speed) 1 -1) speed) (+ steps 1))))
                  (let ((next-q (list)))
                    (when (and (<= (abs (+ pos speed)) (* 2 target))
                               (not (hash-ref visited (list (+ pos speed) (* 2 speed)) #f)))
                      (set! next-q (cons next-a next-q))
                      (hash-set! visited (list (+ pos speed) (* 2 speed)) #t))
                    (when (and (not (= speed 0))
                               (<= (abs pos) (* 2 target))
                               (not (hash-ref visited (list pos (- (if (> 0 speed) 1 -1) speed)) #f)))
                      (set! next-q (cons next-r next-q))
                      (hash-set! visited (list pos (- (if (> 0 speed) 1 -1) speed)) #t))
                    (loop (append (cdr q) next-q))))))))))