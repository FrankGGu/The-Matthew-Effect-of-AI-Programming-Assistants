(define (find-and-replace-string s indices sources targets)
  (let* ((n (string-length s))
         (replacements (make-vector n #f)))
    (for/list ((i (in-range (length indices))))
      (let ((index (list-ref indices i))
            (source (list-ref sources i))
            (target (list-ref targets i)))
        (when (and (>= index 0) (<= index (- n (string-length source))))
          (when (string=? (substring s index (+ index (string-length source))) source)
            (vector-set! replacements index (cons (string-length source) target))))))
    (let loop ((i 0) (result ""))
      (cond
        ((= i n) result)
        ((vector-ref replacements i)
         => (lambda (replacement)
              (let ((len (car replacement))
                    (target (cdr replacement)))
                (loop (+ i len) (string-append result target)))))
        (else (loop (+ i 1) (string-append result (string (string-ref s i)))))))))