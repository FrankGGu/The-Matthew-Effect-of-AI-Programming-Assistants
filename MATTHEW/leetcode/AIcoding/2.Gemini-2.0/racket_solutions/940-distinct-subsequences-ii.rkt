(define (distinct-subseq-ii s)
  (define MOD 1000000007)
  (define last-occurrence (make-vector 256 -1))
  (define (solve s)
    (define n (string-length s))
    (define dp (make-vector (add1 n) 0))
    (vector-set! dp 0 1)
    (for ([i (in-range 1 (add1 n))])
      (let* ([c (string-ref s (sub1 i))]
             [ascii-code (char->integer c)])
        (vector-set! dp i (modulo (* 2 (vector-ref dp (sub1 i))) MOD))
        (when (>= (vector-ref last-occurrence ascii-code) 0)
          (vector-set! dp i (modulo (+ (vector-ref dp i) (- MOD (vector-ref dp (vector-ref last-occurrence ascii-code)))) MOD)))
        (vector-set! last-occurrence ascii-code (sub1 i))))
    (modulo (+ (vector-ref dp n) (- MOD 1)) MOD))
  (solve s))