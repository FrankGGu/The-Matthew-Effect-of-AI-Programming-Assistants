(define (modified-matrix matrix)
  (let* ((rows (length matrix))
         (cols (length (first matrix)))
         (col-max (make-vector cols -1)))
    (for* ((i (in-range rows))
           (j (in-range cols)))
      (set! (vector-ref col-max j) (max (vector-ref col-max j) (list-ref (list-ref matrix i) j))))
    (for* ((i (in-range rows))
           (j (in-range cols)))
      (when (= (list-ref (list-ref matrix i) j) -1)
        (set! (list-ref (list-ref matrix i) j) (vector-ref col-max j))))
    matrix))