(define (count-substrings s k)
  (define (solve s k)
    (let* ((n (string-length s))
           (count 0))
      (for ([i (in-range n)])
        (let loop ([j i] [freq (make-hash)])
          (if (= j n)
              #f
              (let* ((c (string-ref s j))
                     (curr-freq (hash-ref freq c 0)))
                (hash-set! freq c (+ curr-freq 1))
                (let ((distinct-count (hash-count freq)))
                  (if (<= distinct-count k)
                      (begin
                        (set! count (+ count 1))
                        (loop (+ j 1) freq))
                      #f))))))
      count))
  (solve s k))