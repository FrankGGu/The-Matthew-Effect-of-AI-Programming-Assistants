(define (update-matrix matrix)
  (let* ((m (vector-length matrix))
         (n (vector-length (vector-ref matrix 0)))
         (dist (make-vector m (lambda (i) (make-vector n (lambda (j) (if (= (vector-ref (vector-ref matrix i) j) 0) 0 100000))))))
    (for* ((i (in-range m))
           (j (in-range n)))
      (if (> (vector-ref (vector-ref dist i) j) 0)
          (begin
            (when (> i 0)
              (vector-set! (vector-ref dist i) j (min (vector-ref (vector-ref dist i) j) (+ 1 (vector-ref (vector-ref dist (- i 1)) j)))))
            (when (> j 0)
              (vector-set! (vector-ref dist i) j (min (vector-ref (vector-ref dist i) j) (+ 1 (vector-ref (vector-ref dist i) (- j 1)))))))))
    (for* ((i (in-range (sub1 m) -1 -1))
           (j (in-range (sub1 n) -1 -1)))
      (if (> (vector-ref (vector-ref dist i) j) 0)
          (begin
            (when (< i (- m 1))
              (vector-set! (vector-ref dist i) j (min (vector-ref (vector-ref dist i) j) (+ 1 (vector-ref (vector-ref dist (+ i 1)) j)))))
            (when (< j (- n 1))
              (vector-set! (vector-ref dist i) j (min (vector-ref (vector-ref dist i) j) (+ 1 (vector-ref (vector-ref dist i) (+ j 1)))))))))
    dist))