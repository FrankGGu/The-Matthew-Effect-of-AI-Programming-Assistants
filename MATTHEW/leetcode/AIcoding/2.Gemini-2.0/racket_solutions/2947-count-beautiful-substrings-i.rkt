(define (count-vowels str)
  (let loop ([s str] [count 0])
    (if (string=? s "")
        count
        (let ([first-char (string-ref s 0)])
          (loop (substring s 1)
                (if (or (char=? first-char #\a)
                        (char=? first-char #\e)
                        (char=? first-char #\i)
                        (char=? first-char #\o)
                        (char=? first-char #\u))
                    (+ count 1)
                    count))))))

(define (count-beautiful-substrings s k)
  (let ([n (string-length s)])
    (let loop ([i 0] [count 0])
      (if (= i n)
          count
          (let loop2 ([j i])
            (if (= j n)
                (loop (+ i 1) count)
                (let ([sub (substring s i (+ j 1))])
                  (let ([vowels (count-vowels sub)]
                        [consonants (- (string-length sub) vowels)])
                    (loop2 (+ j 1)
                           (if (and (= vowels consonants)
                                    (= (modulo (* vowels consonants) k) 0))
                               (+ count 1)
                               count))))))))))