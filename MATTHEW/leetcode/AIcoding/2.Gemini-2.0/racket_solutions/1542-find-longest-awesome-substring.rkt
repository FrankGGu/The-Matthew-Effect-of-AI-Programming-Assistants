(define (longest-awesome-substring s)
  (define n (string-length s))
  (define mask-map (make-hash))
  (hash-set! mask-map 0 -1)
  (define mask 0)
  (define max-len 0)
  (for ([i (in-range n)])
    (define digit (- (char->integer (string-ref s i)) (char->integer #\0)))
    (set! mask (bitwise-xor mask (arithmetic-shift 1 digit)))
    (if (hash-has-key? mask-map mask)
        (set! max-len (max max-len (- i (hash-ref mask-map mask))))
        (hash-set! mask-map mask i))
    (for ([j (in-range 10)])
      (define new-mask (bitwise-xor mask (arithmetic-shift 1 j)))
      (if (hash-has-key? mask-map new-mask)
          (set! max-len (max max-len (- i (hash-ref mask-map new-mask)))))))
  max-len)