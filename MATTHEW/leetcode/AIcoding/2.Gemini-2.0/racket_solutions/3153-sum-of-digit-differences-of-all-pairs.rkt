(define (sum-digit-difference-pairs nums)
  (let ((n (length nums)))
    (let loop ((i 0) (sum 0))
      (if (= i n)
          sum
          (let loop2 ((j (add1 i)) (sum2 sum))
            (if (= j n)
                (loop (add1 i) sum2)
                (let ((num1 (list->string (map (Î» (c) (string c)) (string->list (number->string (list-ref nums i))))))
                      (num2 (list->string (map (Î» (c) (string c)) (string->list (number->string (list-ref nums j)))))))
                  (let ((min-len (min (string-length num1) (string-length num2))))
                    (let loop3 ((k 0) (diff 0))
                      (if (= k min-len)
                          (loop2 (add1 j) (+ sum2 (abs (- (string->number (substring num1 (- (string-length num1) 1 k) (- (string-length num1) k))) (string->number (substring num2 (- (string-length num2) 1 k) (- (string-length num2) k)))))))
                          (loop3 (add1 k) (+ diff (abs (- (string->number (substring num1 (- (string-length num1) 1 k) (- (string-length num1) k))) (string->number (substring num2 (- (string-length num2) 1 k) (- (string-length num2) k))))))))))))))))