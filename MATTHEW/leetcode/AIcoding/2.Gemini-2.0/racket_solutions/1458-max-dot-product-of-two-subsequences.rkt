(define (max-dot-product nums1 nums2)
  (let ([m (length nums1)]
        [n (length nums2)])
    (define dp (make-vector (+ m 1) (make-vector (+ n 1) -inf.0)))
    (for ([i (in-range 1 (+ m 1))])
      (vector-set! (vector-ref dp i) 0 (max (vector-ref dp i 0) (* (list-ref nums1 (- i 1)) (list-ref nums2 0)))))
    (for ([j (in-range 1 (+ n 1))])
      (vector-set! (vector-ref dp 0) j (max (vector-ref dp 0 j) (* (list-ref nums1 0) (list-ref nums2 (- j 1))))))
    (for ([i (in-range 1 (+ m 1))])
      (for ([j (in-range 1 (+ n 1))])
        (vector-set! (vector-ref dp i) j
                     (max (vector-ref (vector-ref dp (- i 1)) j)
                          (vector-ref (vector-ref dp i) (- j 1))
                          (+ (* (list-ref nums1 (- i 1)) (list-ref nums2 (- j 1)))
                             (max 0 (vector-ref (vector-ref dp (- i 1)) (- j 1))))
                          (* (list-ref nums1 (- i 1)) (list-ref nums2 (- j 1)))))))
    (vector-ref (vector-ref dp m) n)))