(define (calculate-minimum-hp dungeon)
  (let* ((m (length dungeon))
         (n (length (car dungeon)))
         (dp (make-vector (add1 m) (make-vector (add1 n) +inf.0))))
    (vector-set! (vector-ref dp m) n 1)
    (vector-set! (vector-ref dp (sub1 m)) n 1)
    (for* ((i (in-range (sub1 m) -1 -1))
           (j (in-range (sub1 n) -1 -1)))
      (vector-set! (vector-ref dp i) j (max 1 (- (min (vector-ref (vector-ref dp (add1 i)) j) (vector-ref (vector-ref dp i) (add1 j))) (vector-ref (vector-ref dungeon i) j)))))
    (inexact->exact (ceiling (vector-ref (vector-ref dp 0) 0)))))