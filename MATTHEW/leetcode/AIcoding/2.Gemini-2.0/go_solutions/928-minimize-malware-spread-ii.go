func minMalwareSpread(graph [][]int, initial []int) int {
	n := len(graph)
	initialSet := make(map[int]bool)
	for _, node := range initial {
		initialSet[node] = true
	}

	clean := func(infected int) int {
		parent := make([]int, n)
		size := make([]int, n)
		for i := 0; i < n; i++ {
			parent[i] = i
			size[i] = 1
		}

		var find func(int) int
		find = func(x int) int {
			if parent[x] != x {
				parent[x] = find(parent[x])
			}
			return parent[x]
		}

		union := func(x, y int) {
			px, py := find(x), find(y)
			if px != py {
				if size[px] < size[py] {
					px, py = py, px
				}
				parent[py] = px
				size[px] += size[py]
			}
		}

		for i := 0; i < n; i++ {
			if i == infected || initialSet[i] {
				continue
			}
			for j := i + 1; j < n; j++ {
				if j == infected || initialSet[j] {
					continue
				}
				if graph[i][j] == 1 {
					union(i, j)
				}
			}
		}

		affected := make(map[int]int)
		for node := range initialSet {
			if node == infected {
				continue
			}
			p := find(node)
			if _, ok := affected[p]; ok {
				affected[p]++
			} else {
				affected[p] = 1
			}
		}

		res := 0
		for i := 0; i < n; i++ {
			if i == infected || initialSet[i] {
				continue
			}
			p := find(i)
			if affected[p] == 1 {
				res += size[p]
			}
		}
		return res
	}

	bestNode := -1
	maxSaved := -1
	for _, node := range initial {
		saved := clean(node)
		if saved > maxSaved {
			maxSaved = saved
			bestNode = node
		} else if saved == maxSaved && node < bestNode {
			bestNode = node
		}
	}

	if bestNode == -1 {
		minNode := n
		for _, node := range initial {
			if node < minNode {
				minNode = node
			}
		}
		return minNode
	}

	return bestNode
}