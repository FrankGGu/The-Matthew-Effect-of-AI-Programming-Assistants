class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        n = len(graph)
        initial_set = set(initial)

        def dfs(node, visited, infected):
            visited.add(node)
            infected.add(node)
            for neighbor in range(n):
                if graph[node][neighbor] == 1 and neighbor not in visited:
                    dfs(neighbor, visited, infected)

        def get_infected_count(removed_node):
            infected_nodes = set()
            remaining_initial = set(initial) - {removed_node}
            for node in remaining_initial:
                if node not in infected_nodes:
                    dfs(node, set(), infected_nodes)
            return len(infected_nodes)

        min_infected = float('inf')
        result = -1

        for node in initial:
            infected_count = get_infected_count(node)
            if infected_count < min_infected:
                min_infected = infected_count
                result = node
            elif infected_count == min_infected:
                result = min(result, node)

        if result == -1:
            return min(initial)

        return result