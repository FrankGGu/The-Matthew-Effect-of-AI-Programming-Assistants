(define (findCriticalAndPseudoCriticalEdges n edges)
  (define (find parent x)
    (if (= (vector-ref parent x) x)
        x
        (let ((root (find parent (vector-ref parent x))))
          (vector-set! parent x root)
          root)))

  (define (union parent rank x y)
    (let* ((rootX (find parent x))
           (rootY (find parent y)))
      (if (not (= rootX rootY))
          (begin
            (if (> (vector-ref rank rootX) (vector-ref rank rootY))
                (vector-set! parent rootY rootX)
                (begin
                  (vector-set! parent rootX rootY)
                  (when (= (vector-ref rank rootX) (vector-ref rank rootY))
                    (vector-set! rank rootY (+ (vector-ref rank rootY) 1)))))))))

  (define (kruskal edges)
    (define parent (vector))
    (define rank (vector))
    (for ((i (in-range n)))
      (vector-set! parent i i)
      (vector-set! rank i 0))
    (define mst-cost 0)
    (define mst-edges '())
    (for ((edge edges))
      (define (index x) (vector-ref edge 0))
      (define (index y) (vector-ref edge 1))
      (define (cost) (vector-ref edge 2))
      (let ((u (index edge))
            (v (index edge))
            (w (cost edge)))
        (let ((parent-copy (vector-copy parent))
              (rank-copy (vector-copy rank)))
          (union parent-copy rank-copy u v)
          (if (= (find parent-copy u) (find parent-copy v))
              (begin)
              (begin
                (set! mst-cost (+ mst-cost w))
                (set! mst-edges (cons edge mst-edges))
                (union parent u v))))))
    (values mst-cost mst-edges))

  (define critical '())
  (define pseudo '())
  (define sorted-edges (sort edges (lambda (a b) (< (vector-ref a 2) (vector-ref b 2)))))

  (for ((i (in-range (length sorted-edges))))
    (define edge-to-remove (vector-ref sorted-edges i))
    (define (mst-cost-without-edge) (kruskal (remove edge-to-remove sorted-edges)))
    (define (mst-cost-with-edge) (kruskal sorted-edges))

    (if (< (mst-cost-without-edge) (mst-cost-with-edge))
        (set! critical (cons (vector-ref edge-to-remove 3) critical))
        (if (= (mst-cost-without-edge) (mst-cost-with-edge))
            (set! pseudo (cons (vector-ref edge-to-remove 3) pseudo)))))

  (values (reverse critical) (reverse pseudo)))