(define (query-string S N)
  (define (substring-representing? s n)
    (let loop ((i 0))
      (cond ((>= i (string-length s)) #f)
            ((= (string->number (substring s i (+ i (string-length (number->string n))))) n) n) #t)
            (else (loop (+ i 1))))))
  (define (all-substrings s)
    (define (loop prefix n)
      (if (= n 0)
          (list prefix)
          (append (loop (string-append prefix "0") (- n 1))
                  (loop (string-append prefix "1") (- n 1)))))
    (loop "" (string-length S)))
  (define substrings (all-substrings S))
  (for/or ([n (in-range 1 (+ N 1))])
    (substring-representing? S n)))