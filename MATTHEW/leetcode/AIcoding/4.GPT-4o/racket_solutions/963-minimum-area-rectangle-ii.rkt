(define (min-area-rect points)
  (define point-set (make-hash))
  (for-each (lambda (p) (hash-set! point-set p #t)) points)
  (define min-area +inf.0)
  (define n (length points))
  (for ([i (in-range n)])
    (for ([j (in-range i)])
      (define p1 (list (car (list-ref points i)) (cadr (list-ref points i))))
      (define p2 (list (car (list-ref points j)) (cadr (list-ref points j))))
      (when (and (not (= (car p1) (car p2))) (not (= (cadr p1) (cadr p2))))
        (define p3 (list (car p1) (cadr p2)))
        (define p4 (list (car p2) (cadr p1)))
        (when (and (hash-has-key? point-set p3) (hash-has-key? point-set p4))
          (define area (* (abs (- (car p1) (car p2))) (abs (- (cadr p1) (cadr p2)))))
          (set! min-area (min min-area area)))))
  (if (= min-area +inf.0) 0 min-area))