(define (handOfStraights hand W)
  (define sorted-hand (sort hand <))
  (define (can-form-straights hand W)
    (if (null? hand) (null? W)
        (let ([first (car hand)])
          (for/fold ([new-hand '()]
                      [remaining hand])
                     (define (update-hand h r)
                       (if (null? r)
                           (if (null? h) h (cons (car h) (cdr h)))
                           (if (and (= (car r) first)
                                    (<= (length h) W))
                               (update-hand (cons (car r) h) (cdr r))
                               h)))
                     (update-hand '() remaining)))
          (if (null? new-hand) #f
              (can-form-straights (filter (lambda (x) (not (member x new-hand))) hand) W))))))
  (and (zero? (modulo (length hand) W))
       (can-form-straights sorted-hand W)))