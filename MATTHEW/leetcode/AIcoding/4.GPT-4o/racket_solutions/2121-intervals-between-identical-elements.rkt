(define (get-intervals nums)
  (define index-map (make-hash))
  (define intervals (make-vector (vector-length nums) 0))
  (for ([i (in-range (vector-length nums))])
    (define num (vector-ref nums i))
    (if (hash-has-key? index-map num)
      (let ([last-index (hash-ref index-map num)])
        (vector-set! intervals last-index (+ (vector-ref intervals last-index) (- i last-index)))
        (vector-set! intervals i (+ (vector-ref intervals i) (- i last-index))))
      (hash-set! index-map num i)))
  (for ([i (in-range (vector-length nums))])
    (if (hash-has-key? index-map (vector-ref nums i))
      (vector-set! intervals i (+ (vector-ref intervals i) (- (vector-length nums) i)))))
  intervals)

(define (intervalsBetweenIdenticalElements nums)
  (get-intervals (vector->list nums)))