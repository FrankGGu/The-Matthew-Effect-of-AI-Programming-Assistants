(define (findKthLargest nums k)
  (define (quickselect left right)
    (if (= left right)
        (list-ref nums left)
        (let* ((pivot (list-ref nums right))
               (partition (lambda (left right)
                            (let loop ((i left) (j right))
                              (cond
                                ((> i j) j)
                                ((< (list-ref nums i) pivot) (loop (+ i 1) j))
                                (else (swap! nums i j)
                                      (loop (+ i 1) (- j 1)))))))
               (pivot-index (partition left right)))
          (if (= pivot-index (- (length nums) k))
              (list-ref nums pivot-index)
              (if (< pivot-index (- (length nums) k))
                  (quickselect (+ pivot-index 1) right)
                  (quickselect left (- pivot-index 1)))))))
  (quickselect 0 (- (length nums) 1)))

(define (swap! lst i j)
  (let ((temp (list-ref lst i)))
    (set! (list-ref lst i) (list-ref lst j))
    (set! (list-ref lst j) temp)))

(findKthLargest nums k)