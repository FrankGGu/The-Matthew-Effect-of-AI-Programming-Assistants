(define (longestVShapedDiagonalSegment matrix)
  (define n (length matrix))
  (define m (if (zero? n) 0 (length (car matrix))))
  (define max-length 0)

  (for* ((i (in-range n))
         (j (in-range m)))
    (when (and (< j m) (< i n))
      (define length 1)
      (define x i)
      (define y j)
      (while (and (< x n) (< y m))
        (if (and (< (add1 x) n) (< (add1 y) m) 
                 (= (list-ref (list-ref matrix x) y) 
                    (list-ref (list-ref matrix (add1 x)) (add1 y))))
            (begin
              (set! length (add1 length))
              (set! x (add1 x))
              (set! y (add1 y)))
            (begin
              (set! x (add1 x))
              (set! y (sub1 y))))
        (set! max-length (max max-length length))))
  max-length)