(define (maxAreaOfSquare grid)
  (define rows (length grid))
  (define cols (length (car grid)))
  (define dp (make-vector rows (make-vector cols 0)))
  (define max-side 0)

  (for* ((i (in-range rows))
         (j (in-range cols)))
    (when (= (list-ref (list-ref grid i) j) 1)
      (if (or (= i 0) (= j 0))
          (set! (vector-ref (vector-ref dp i) j) 1)
          (set! (vector-ref (vector-ref dp i) j)
                (+ 1 (min (vector-ref (vector-ref dp (- i 1)) j)
                          (vector-ref (vector-ref dp i (- j 1)))
                          (vector-ref (vector-ref dp (- i 1) (- j 1))))))
          (set! max-side (max max-side (vector-ref (vector-ref dp i) j)))))
  (* max-side max-side))