(define (min-area-rect points)
  (define point-set (set points))
  (define min-area +inf.0)
  (define (update-min-area p1 p2)
    (let* ((x1 (car p1)) (y1 (cadr p1))
           (x2 (car p2)) (y2 (cadr p2)))
      (if (and (not (= x1 x2)) (not (= y1 y2)))
          (let ((area (* (abs (- x1 x2)) (abs (- y1 y2)))))
            (set! min-area (min min-area area))))))
  (for ([i (in-range (length points))])
    (for ([j (in-range i (length points))])
      (let ((p1 (list-ref points i))
            (p2 (list-ref points j)))
        (when (and (not (= p1 p2))
                   (set-contains? point-set (list (car p1) (cadr p2)))
                   (set-contains? point-set (list (car p2) (cadr p1))))
          (update-min-area p1 p2)))))
  (if (= min-area +inf.0) 0 min-area))

(define (set-contains? s x)
  (for/or ([item (in-set s)])
    (equal? item x))

(define (minAreaRect points)
  (min-area-rect points))