(define (minimum-time-to-visit-cell grid)
  (define n (length grid))
  (define m (length (car grid)))
  (define directions '((0 1) (1 0) (0 -1) (-1 0)))
  (define (in-bounds? x y)
    (and (>= x 0) (< x n) (>= y 0) (< y m)))
  (define (bfs)
    (define queue (list (list 0 0 0)))
    (define visited (make-vector (* n m) #f))
    (vector-set! visited 0 #t)
    (define min-time #f)
    (define find-min (lambda ()
                       (if (null? queue)
                           min-time
                           (let* ((current (car queue))
                                  (queue (cdr queue))
                                  (x (car current))
                                  (y (cadr current))
                                  (time (caddr current)))
                             (if (and (= x (- n 1)) (= y (- m 1)))
                                 (begin
                                   (set! min-time (if (not min-time) time (min min-time time)))
                                   (find-min))
                                 (for-each (lambda (dir)
                                             (let* ((new-x (+ x (car dir)))
                                                    (new-y (+ y (cadr dir)))
                                                    (new-time (if (even? (+ x y)) 
                                                                  (+ time 1)
                                                                  (+ time 2))))
                                               (when (and (in-bounds? new-x new-y)
                                                          (not (vector-ref visited (+ (* new-x m) new-y)))
                                                          (<= new-time (vector-ref grid new-x)))
                                                 (vector-set! visited (+ (* new-x m) new-y) #t)
                                                 (set! queue (append queue (list (list new-x new-y new-time)))))))
                                           directions)
                             (find-min))))))
  (bfs))

(minimum-time-to-visit-cell '((0 1 2) (3 4 5) (6 7 8)))