(define (merge-stones stones K)
  (define n (length stones))
  (if (or (= n 1) (not (= (modulo (- n 1) (- K 1)) 0)))
      0)
  (define dp (make-vector n (make-vector n (make-vector (+ 1 n) +inf.0))))
  (define prefix-sum (make-vector (+ 1 n) 0))
  (for ([i (in-range n)])
    (vector-set! prefix-sum (+ 1 i) (+ (vector-ref prefix-sum i) (list-ref stones i))))
  (for ([i (in-range n)])
    (vector-set! (vector-ref dp i) i 0))
  (for ([length (in-range 2 n)]
        [i (in-range (- n length) (+ 1))]
        [j (in-range (+ i length -1) (+ 1 n))])
    (for ([k (in-range i (+ i length -1))])
      (vector-set! (vector-ref dp i) (+ i length -1) 
                   (min (vector-ref (vector-ref dp i) (+ i length -1)) 
                        (+ (vector-ref (vector-ref dp i) k)
                           (vector-ref (vector-ref dp (+ 1 k)) (+ i length -1))
                           (if (= K 2) 0 (vector-ref prefix-sum (+ i length -1))))))
    (when (= K 2)
      (vector-set! (vector-ref dp i) (+ i length -1) 
                   (+ (vector-ref (vector-ref dp i) (+ i length -1))
                      (vector-ref prefix-sum (+ i length -1))))))
  (vector-ref (vector-ref dp 0) (- n 1)))

(define (min-cost-merge-stones stones K)
  (merge-stones stones K))