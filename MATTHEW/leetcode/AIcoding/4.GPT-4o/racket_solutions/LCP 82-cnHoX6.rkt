(define (binary-tree-vertical-order-traversal root)
  (define (helper node col level)
    (if (null? node)
        '()
        (cons (list col level (val node))
              (append (helper (left node) (- col 1) (+ level 1))
                      (helper (right node) (+ col 1) (+ level 1))))))
  (define (sort-and-group lst)
    (define grouped (make-hash))
    (for-each (lambda (item)
                (define key (car item))
                (define val (caddr item))
                (define level (cadr item))
                (hash-set! grouped key (cons (list level val) (hash-ref grouped key '()))))
              lst)
    (define sorted-keys (sort (hash-keys grouped) <))
    (map (lambda (key)
           (map second (sort (hash-ref grouped key) (lambda (x y) (if (= (car x) (car y)) (< (cadr x) (cadr y)) (< (car x) (car y)))))))
         sorted-keys))
  (define vals (helper root 0 0))
  (sort-and-group vals))