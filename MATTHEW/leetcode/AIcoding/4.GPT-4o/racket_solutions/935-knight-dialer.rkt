(define (knightDialer n)
  (define moves '((4 6) (6 4) (3 8) (8 3) (1 6) (6 1) (7 2) (2 7) (0 4) (4 0) (3 1) (1 3) (2 9) (9 2) (5 0) (0 5) (7 4) (4 7) (8 1) (1 8) (5 1) (1 5) (2 5) (5 2) (7 5) (5 7) (9 6) (6 9) (8 5) (5 8) (2 3) (3 2) (1 0) (0 1) (2 4) (4 2) (5 4) (4 5) (1 9) (9 1)))
  (define dp (make-vector 10 (lambda () (make-vector (+ n 1) 0))))
  (for ((i (in-range 10)))
    (vector-set! dp i 1))
  (for ((i (in-range 1 n)))
    (for ((j (in-range 10)))
      (for ((move (list-ref moves j)))
        (let ((next (car move)))
          (vector-set! (vector-ref dp j) (+ i 1) 
                       (+ (vector-ref (vector-ref dp next) i)
                          (vector-ref (vector-ref dp (cadr move)) i))))))
    )
  (apply + (for/fold ([total 0]) ((i (in-range 10))) 
                (+ total (vector-ref (vector-ref dp i) n)))))