(define (largestVariance s)
  (define (calcVariance a b)
    (define freq (make-vector 128 0))
    (define maxVar 0)
    (define countA 0)
    (define countB 0)
    (for-each (lambda (c)
                (vector-set! freq (char->integer c) (+ (vector-ref freq (char->integer c)) 1)))
                (when (eq? c a) (set! countA (+ countA 1)))
                (when (eq? c b) (set! countB (+ countB 1))))
              (string->list s))
    (when (and (> countA 0) (> countB 0))
      (for-each (lambda (c)
                  (when (eq? (char->integer c) (char->integer a))
                    (set! countA (+ countA 1))
                    (set! countB (- countB 1)))
                  (when (eq? (char->integer c) (char->integer b))
                    (set! countB (+ countB 1))
                    (set! countA (- countA 1)))
                  (when (and (>= countA 0) (>= countB 0))
                    (set! maxVar (max maxVar (- countA countB)))))
                (string->list s))
      maxVar))
  (define maxVariance 0)
  (for ([i (in-range (string-length s))])
    (for ([j (in-range (string-length s))])
      (when (not (= i j))
        (set! maxVariance (max maxVariance (calcVariance (string-ref s i) (string-ref s j))))))
    )
  maxVariance)