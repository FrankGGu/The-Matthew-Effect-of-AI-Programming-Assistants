(define (smallestSubsequence s)
  (define n (string-length s))
  (define last (make-vector 26 0))
  (for ([i (in-range n)])
    (vector-set! last (- (char->integer (string-ref s i)) (char->integer #\a)) i))
  (define stack '())
  (define in-stack (make-vector 26 #f))
  (for ([i (in-range n)])
    (define c (string-ref s i))
    (when (not (vector-ref in-stack (- (char->integer c) (char->integer #\a))))
      (while (and (not (null? stack))
                  (> (char->integer (car stack)) (char->integer c))
                  (< (vector-ref last (- (char->integer (car stack)) (char->integer #\a))) i))
        (set! in-stack (vector-set! in-stack (- (char->integer (car stack)) (char->integer #\a)) #f)
              (set! stack (cdr stack)))
      (set! in-stack (vector-set! in-stack (- (char->integer c) (char->integer #\a)) #t)
            (set! stack (cons c stack))))
  (apply string (reverse stack)))