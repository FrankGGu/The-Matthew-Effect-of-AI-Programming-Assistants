(define (Solution rectangles)
  (define total-area (apply + (map (λ (rect) (* (- (second rect) (first rect)) 
                                                       (- (fourth rect) (third rect)))) 
                                     rectangles)))
  (define cumulative-areas (let loop ((rects rectangles) (acc 0) (areas '()))
                              (if (null? rects)
                                  (reverse areas)
                                  (let* ((rect (car rects))
                                         (area (* (- (second rect) (first rect)) 
                                                   (- (fourth rect) (third rect))))
                                         (new-acc (+ acc area)))
                                    (loop (cdr rects) new-acc (cons new-acc areas))))))
  (define (pick-random-point)
    (define target (random total-area))
    (define idx (find-index (λ (x) (>= target x)) cumulative-areas))
    (define rect (list-ref rectangles idx))
    (define x (+ (first rect) (random (- (second rect) (first rect)))))
    (define y (+ (third rect) (random (- (fourth rect) (third rect)))))
    (list x y))

  (define (random-point)
    (pick-random-point))

  (define (find-index pred lst)
    (let loop ((lst lst) (idx 0))
      (cond
        ((null? lst) idx)
        ((pred (car lst)) idx)
        (else (loop (cdr lst) (+ idx 1))))))

  (list random-point))