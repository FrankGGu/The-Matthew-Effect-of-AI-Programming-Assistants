(define (minimize-malware-spread graph initial)
  (define n (length graph))
  (define visited (make-vector n #f))
  (define component (make-vector n '()))

  (define (dfs node comp)
    (vector-set! visited node #t)
    (vector-set! comp (vector-ref comp node) (cons node (vector-ref comp node)))
    (for ([neighbor (in-list (vector-ref graph node))])
      (when (and (not (vector-ref visited neighbor)) (not (= neighbor node)))
        (dfs neighbor comp)))
    comp)

  (for ([i (in-range n)])
    (when (not (vector-ref visited i))
      (dfs i (vector-set! component i '()))))

  (define malware-count (make-vector n 0))

  (for ([malware (in-list initial)])
    (for ([node (in-list (vector-ref component malware))])
      (vector-set! malware-count node (+ 1 (vector-ref malware-count node)))))

  (define (best-node)
    (define best -1)
    (define min-malware +inf.0)
    (for ([i (in-list initial)])
      (define count (vector-ref malware-count i))
      (when (and (< count min-malware) (or (= best -1) (> i best)))
        (set! min-malware count)
        (set! best i)))
    best)

  (best-node))