(define (word-break-ii s wordDict)
  (define (can-segment start)
    (if (>= start (string-length s))
        (list '())
        (if (hash-ref memo start #f)
            (hash-ref memo start)
            (begin
              (define result '())
              (for-each (lambda (word)
                          (define word-len (string-length word))
                          (when (and (<= (+ start word-len) (string-length s))
                                     (string=? (substring s start (+ start word-len)) word))
                            (for-each (lambda (suffix)
                                        (set! result (cons (string-append word " " suffix) result)))
                                      (can-segment (+ start word-len))))
                        wordDict)
              (hash-set! memo start result)
              result))))

  (define memo (make-hash))
  (define segments (can-segment 0))
  (map (lambda (seg) (string-trim-right seg)) segments))

(define (wordBreak s wordDict)
  (word-break-ii s (set wordDict)))