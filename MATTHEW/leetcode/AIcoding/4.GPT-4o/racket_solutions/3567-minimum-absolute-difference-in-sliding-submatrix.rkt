(define (minimum-absolute-difference matrix k)
  (define n (vector-length matrix))
  (define m (vector-length (vector-ref matrix 0)))
  (define (get-sorted-submatrix r c)
    (define lst '())
    (for ([i (in-range r (+ r k))])
      (for ([j (in-range c (+ c k))])
        (set! lst (cons (vector-ref (vector-ref matrix i) j) lst))))
    (sort lst <))

  (define min-diff +inf.0)
  (for ([i (in-range (- n k 1))])
    (for ([j (in-range (- m k 1))])
      (define sorted-submatrix (get-sorted-submatrix i j))
      (for ([x (in-range (vector-length sorted-submatrix) -1)])
        (define diff (- (vector-ref sorted-submatrix (+ x 1)) (vector-ref sorted-submatrix x)))
        (set! min-diff (min min-diff diff)))))
  min-diff)