(define (max-vowels s k)
  (define (is-vowel c)
    (member c '(#\a #\e #\i #\o #\u)))
  (define (count-vowels str)
    (foldl (lambda (c acc) (if (is-vowel c) (+ acc 1) acc)) 0 str))
  (define n (string-length s))
  (if (<= n k)
      (count-vowels s)
      (let loop ((i 0) (current-vowel-count (count-vowels (substring s 0 k))) (max-count current-vowel-count))
        (if (>= i (- n k))
            max-count
            (let ((next-vowel-count (if (is-vowel (string-ref s (+ i k)))
                                         (+ current-vowel-count 1)
                                         current-vowel-count)))
              (let ((prev-vowel-count (if (is-vowel (string-ref s i))
                                          (- next-vowel-count 1)
                                          next-vowel-count)))
                (loop (+ i 1) prev-vowel-count (max max-count prev-vowel-count))))))))