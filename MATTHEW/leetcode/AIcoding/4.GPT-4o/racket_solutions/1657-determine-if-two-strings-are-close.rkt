(define (close-strings word1 word2)
  (if (not (= (string-length word1) (string-length word2)))
      #f
      (let* ((freq1 (make-hash))
             (freq2 (make-hash)))
        (for ([c (in-string word1)])
          (hash-set! freq1 c (add1 (hash-ref freq1 c 0))))
        (for ([c (in-string word2)])
          (hash-set! freq2 c (add1 (hash-ref freq2 c 0))))
        (define keys1 (hash-keys freq1))
        (define keys2 (hash-keys freq2))
        (define vals1 (sort (hash-values freq1) <))
        (define vals2 (sort (hash-values freq2) <))
        (and (equal? (sort keys1 <) (sort keys2 <))
             (equal? vals1 vals2)))))