(define (spiral-matrix matrix)
  (define (spiral-helper top left bottom right acc)
    (when (<= top bottom)
      (for ([i left right])
        (set! acc (append acc (list (list-ref (list-ref matrix top) i)))))
      (set! top (+ top 1)))
    (when (<= left right)
      (for ([i top bottom])
        (set! acc (append acc (list (list-ref (list-ref matrix i) right)))))
      (set! right (- right 1)))
    (when (<= top bottom)
      (for ([i right left])
        (set! acc (append acc (list (list-ref (list-ref matrix bottom) i)))))
      (set! bottom (- bottom 1)))
    (when (<= left right)
      (for ([i bottom top])
        (set! acc (append acc (list (list-ref (list-ref matrix i) left)))))
      (set! left (+ left 1)))
    (if (or (> top bottom) (> left right))
        acc
        (spiral-helper top left bottom right acc)))
  (spiral-helper 0 0 (- (length matrix) 1) (- (length (first matrix)) 1) '()))