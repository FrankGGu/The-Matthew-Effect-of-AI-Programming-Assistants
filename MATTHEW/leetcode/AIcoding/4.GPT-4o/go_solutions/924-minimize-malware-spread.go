package main

import "sort"

func minMalwareSpread(graph [][]int, initial []int) int {
    n := len(graph)
    sort.Ints(initial)

    parent := make([]int, n)
    size := make([]int, n)
    infected := make([]int, n)

    for i := 0; i < n; i++ {
        parent[i] = i
        size[i] = 1
    }

    var find func(x int) int
    find = func(x int) int {
        if parent[x] != x {
            parent[x] = find(parent[x])
        }
        return parent[x]
    }

    var union func(x, y int)
    union = func(x, y int) {
        rootX := find(x)
        rootY := find(y)
        if rootX != rootY {
            if size[rootX] < size[rootY] {
                rootX, rootY = rootY, rootX
            }
            parent[rootY] = rootX
            size[rootX] += size[rootY]
        }
    }

    for i := 0; i < n; i++ {
        for j := 0; j < n; j++ {
            if graph[i][j] == 1 {
                union(i, j)
            }
        }
    }

    count := make(map[int]int)
    for _, node := range initial {
        root := find(node)
        count[root]++
    }

    result := -1
    maxSize := -1

    for _, node := range initial {
        root := find(node)
        if count[root] == 1 {
            if size[root] > maxSize || (size[root] == maxSize && result > node) {
                result = node
                maxSize = size[root]
            }
        }
    }

    if result == -1 {
        return initial[0]
    }
    return result
}