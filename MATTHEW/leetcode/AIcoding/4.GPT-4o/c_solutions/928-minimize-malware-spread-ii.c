int minMalwareSpread(int** graph, int graphSize, int* graphColSize, int* initial, int initialSize) {
    int n = graphSize, result = -1, minSize = INT_MAX;
    int* color = (int*)calloc(n, sizeof(int));
    int* count = (int*)calloc(n, sizeof(int));
    int* size = (int*)calloc(n, sizeof(int));
    int* visited = (int*)calloc(n, sizeof(int));

    for (int i = 0; i < initialSize; i++) {
        visited[initial[i]] = 1;
    }

    for (int i = 0; i < n; i++) {
        if (!visited[i]) {
            int groupSize = 0;
            for (int j = 0; j < n; j++) {
                if (graph[i][j] == 1) {
                    groupSize++;
                }
            }
            size[i] = groupSize;
            for (int j = 0; j < n; j++) {
                if (graph[i][j] == 1 && !visited[j]) {
                    count[j]++;
                }
            }
        }
    }

    for (int i = 0; i < initialSize; i++) {
        int node = initial[i];
        int totalAffected = 0;
        for (int j = 0; j < n; j++) {
            if (graph[node][j] == 1 && visited[j]) {
                totalAffected++;
            }
        }
        if (totalAffected < minSize || (totalAffected == minSize && node < result)) {
            minSize = totalAffected;
            result = node;
        }
    }

    free(color);
    free(count);
    free(size);
    free(visited);

    return result;
}