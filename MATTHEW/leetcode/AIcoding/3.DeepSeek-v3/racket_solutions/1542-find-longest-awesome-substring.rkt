(define (longest-awesome s)
  (let ((n (string-length s))
        (mask 0)
        (first-pos (make-hash))
        (max-len 0))
    (hash-set! first-pos 0 -1)
    (for ((i (in-range n)))
      (let ((c (string-ref s i)))
        (set! mask (bitwise-xor mask (arithmetic-shift 1 (- (char->integer c) (char->integer #\0)))))
        (unless (hash-has-key? first-pos mask)
          (hash-set! first-pos mask i))
        (set! max-len (max max-len (- i (hash-ref first-pos mask))))
      (for ((d (in-range 10)))
        (let ((temp-mask (bitwise-xor mask (arithmetic-shift 1 d))))
          (when (hash-has-key? first-pos temp-mask)
            (set! max-len (max max-len (- i (hash-ref first-pos temp-mask))))))))
    max-len))