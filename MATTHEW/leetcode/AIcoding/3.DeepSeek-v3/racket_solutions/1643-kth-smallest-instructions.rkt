(define (kthSmallestPath destination k)
  (let* ((v (car destination))
         (h (cadr destination))
         (total (+ v h))
         (comb (make-vector (* (add1 v) (add1 h)) 1)))
    (for ([i (in-range 1 (add1 total))])
      (for ([j (in-range 0 (add1 (min i v)))])
        (when (<= (- i j) h)
          (vector-set! comb (+ j (* (add1 v) (- i j)))
                       (if (or (zero? j) (zero? (- i j)))
                           1
                           (+ (vector-ref comb (+ (sub1 j) (* (add1 v) (- i j)))
                              (vector-ref comb (+ j (* (add1 v) (sub1 (- i j))))))))))))
    (let loop ([v v] [h h] [k k] [res '()])
      (if (zero? (+ v h))
          (list->string (reverse res))
          (let ((c (if (zero? v)
                       (begin (set! h (sub1 h)) #\H)
                       (if (zero? h)
                           (begin (set! v (sub1 v)) #\V)
                           (let ((cnt (vector-ref comb (+ (sub1 v) (* (add1 v) h)))))
                             (if (<= k cnt)
                                 (begin (set! h (sub1 h)) #\H)
                                 (begin (set! k (- k cnt)) (set! v (sub1 v)) #\V))))))
            (loop v h k (cons c res)))))))