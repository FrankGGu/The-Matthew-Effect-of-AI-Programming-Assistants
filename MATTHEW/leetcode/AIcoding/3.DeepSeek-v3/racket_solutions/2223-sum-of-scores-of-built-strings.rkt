(define (sum-scores s)
  (define n (string-length s))
  (define z (make-vector n 0))
  (vector-set! z 0 n)
  (define l 0)
  (define r 0)
  (for ([i (in-range 1 n)])
    (when (<= i r)
      (vector-set! z i (min (- r i) (vector-ref z (- i l)))))
    (while (and (< (+ i (vector-ref z i)) n)
           (equal? (string-ref s (vector-ref z i))
                   (string-ref s (+ i (vector-ref z i)))))
      (vector-set! z i (+ (vector-ref z i) 1)))
    (when (> (+ i (vector-ref z i) -1) r)
      (set! l i)
      (set! r (+ i (vector-ref z i) -1)))
  (apply + (vector->list z)))