(define (largest-integer num)
  (let* ((s (string->list (number->string num)))
         (evens (filter (lambda (c) (even? (- (char->integer c) (char->integer #\0)))) s))
         (odds (filter (lambda (c) (odd? (- (char->integer c) (char->integer #\0)))) s)
         (sorted-evens (sort evens char>?))
         (sorted-odds (sort odds char>?))
         (result (list->string
                  (let loop ((s s) (e sorted-evens) (o sorted-odds))
                    (if (null? s)
                        '()
                        (let ((c (car s)))
                          (if (even? (- (char->integer c) (char->integer #\0)))
                              (cons (car e) (loop (cdr s) (cdr e) o))
                              (cons (car o) (loop (cdr s) e (cdr o))))))))))
    (string->number result)))