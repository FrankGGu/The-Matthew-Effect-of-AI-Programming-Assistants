class Solution:
    def minMalwareSpread(self, net: List[List[int]], mal: List[int]) -> int:
        from collections import defaultdict, deque

        def bfs(start, visited):
            q = deque([start])
            visited[start] = True
            count = 0
            while q:
                node = q.popleft()
                count += 1
                for neighbor in range(len(net)):
                    if net[node][neighbor] and not visited[neighbor]:
                        visited[neighbor] = True
                        q.append(neighbor)
            return count

        n = len(net)
        visited = [False] * n
        groups = []
        for i in range(n):
            if not visited[i]:
                groups.append(bfs(i, visited))

        mal_set = set(mal)
        result = 0
        max_count = 0
        for i in range(n):
            if i not in mal_set:
                cnt = 0
                for j in mal:
                    if net[i][j] or net[j][i]:
                        cnt += 1
                if cnt == 1:
                    if groups[i] > max_count:
                        max_count = groups[i]
                        result = i
        return result