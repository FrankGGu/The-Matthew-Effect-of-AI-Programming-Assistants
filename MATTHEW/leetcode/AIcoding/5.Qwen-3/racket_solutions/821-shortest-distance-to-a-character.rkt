(define (shortest-distance-to-a-character s c)
  (let ((n (string-length s))
        (res (make-vector (string-length s) 0)))
    (let loop ((i 0) (last -1))
      (when (< i n)
        (when (= (string-ref s i) c)
          (set! last i)
          (vector-set! res i 0))
        (when (not (= last -1))
          (vector-set! res i (- i last)))
        (loop (+ i 1) last)))
    (let loop ((i (- n 1)) (last -1))
      (when (>= i 0)
        (when (= (string-ref s i) c)
          (set! last i)
          (vector-set! res i 0))
        (when (not (= last -1))
          (vector-set! res i (min (vector-ref res i) (- last i))))
        (loop (- i 1) last)))
    (vector->list res)))