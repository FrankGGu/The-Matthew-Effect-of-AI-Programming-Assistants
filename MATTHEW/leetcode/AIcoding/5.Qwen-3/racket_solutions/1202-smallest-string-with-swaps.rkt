#lang racket

(define/contract (smallest-string-with-swaps s pairs)
  (-> string? (listof (listof exact-integer?)) string?)
  (define n (string-length s))
  (define parent (make-vector n 0))
  (define (find x)
    (if (= (vector-ref parent x) x)
        x
        (let ([p (find (vector-ref parent x))])
          (vector-set! parent x p)
          p)))
  (define (union x y)
    (define px (find x))
    (define py (find y))
    (when (not (= px py))
      (vector-set! parent px py)))
  (for-each (lambda (pair) (union (car pair) (cadr pair))) pairs)
  (define groups (make-hash))
  (for ([i (in-range n)])
    (define root (find i))
    (hash-update! groups root (λ (lst) (cons i lst)) '()))
  (define res (string->list s))
  (for ([(k v) (in-hash groups)])
    (define indices (reverse v))
    (define chars (map (λ (i) (list-ref res i)) indices))
    (set! chars (sort chars char<?))
    (for ([i (in-range (length indices))])
      (list-set! res (list-ref indices i) (list-ref chars i))))
  (list->string res))