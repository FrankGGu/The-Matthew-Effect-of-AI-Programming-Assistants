(define (max-value grid)
  (define rows (length grid))
  (define cols (length (car grid)))
  (define dp (make-vector rows (make-vector cols 0)))
  (vector-set! dp 0 0 (vector-ref (vector-ref grid 0) 0))
  (for ([i (in-range 1 rows)])
    (vector-set! dp i 0 (+ (vector-ref (vector-ref grid i) 0) (vector-ref dp (sub1 i) 0))))
  (for ([j (in-range 1 cols)])
    (vector-set! dp 0 j (+ (vector-ref (vector-ref grid 0) j) (vector-ref dp 0 (sub1 j)))))
  (for ([i (in-range 1 rows)])
    (for ([j (in-range 1 cols)])
      (vector-set! dp i j
                   (+ (vector-ref (vector-ref grid i) j)
                      (max (vector-ref dp (sub1 i) j)
                           (vector-ref dp i (sub1 j)))))))
  (vector-ref dp (sub1 rows) (sub1 cols)))