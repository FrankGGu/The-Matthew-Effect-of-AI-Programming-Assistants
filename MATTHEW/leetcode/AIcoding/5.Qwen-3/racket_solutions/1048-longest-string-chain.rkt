(define (longest-string-chain words)
  (define (compare a b)
    (< (string-length a) (string-length b)))
  (define sorted-words (sort words compare))
  (define dp (make-hash))
  (for ([word sorted-words])
    (hash-set! dp word 1)
    (for ([i (in-range (string-length word))])
      (define candidate (string-append (substring word 0 i) (substring word (add1 i))))
      (when (hash-has-key? dp candidate)
        (hash-set! dp word (max (hash-ref dp word) (+ (hash-ref dp candidate) 1))))))
  (apply max (hash-values dp)))