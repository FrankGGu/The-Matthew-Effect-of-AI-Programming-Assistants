(define (three-sum nums)
  (define (sort-list lst)
    (cond ((null? lst) '())
          ((null? (cdr lst)) lst)
          (else (let ((mid (quotient (length lst) 2)))
                  (merge (sort-list (take lst mid))
                         (sort-list (drop lst mid)))))))
  (define (merge left right)
    (cond ((null? left) right)
          ((null? right) left)
          ((<= (car left) (car right))
           (cons (car left) (merge (cdr left) right)))
          (else (cons (car right) (merge left (cdr right))))))
  (define (two-sum lst target start)
    (define (helper i j res)
      (cond ((>= i j) res)
            ((= (+ (list-ref lst i) (list-ref lst j)) target)
             (helper (add1 i) (sub1 j) (cons (list (list-ref lst i) (list-ref lst j)) res)))
            ((< (+ (list-ref lst i) (list-ref lst j)) target)
             (helper (add1 i) j res))
            (else (helper i (sub1 j) res))))
    (reverse (helper 0 (sub1 (length lst)) '())))
  (define (three-sum-helper nums sorted)
    (cond ((null? nums) '())
          ((= (length nums) 2)
           (if (= (apply + nums) 0)
               (list nums)
               '()))
          (else
           (let ((current (car nums))
                 (rest (cdr nums)))
             (append (if (= (car rest) current)
                         '()
                         (map (lambda (x) (cons current x))
                              (two-sum (cdr rest) (- (car nums)) 0)))
                     (three-sum-helper (cdr nums) (cdr sorted)))))))
  (if (< (length nums) 3)
      '()
      (let ((sorted (sort-list nums)))
        (remove-duplicates (three-sum-helper sorted sorted)))))