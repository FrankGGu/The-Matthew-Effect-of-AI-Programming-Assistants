(define (get-permutation n k)
  (define digits (range 1 (+ n 1)))
  (define (factorial x)
    (if (= x 0) 1 (* x (factorial (- x 1)))))
  (define (perm-seq digits k)
    (if (null? digits)
        ""
        (let* ((fact (factorial (- (length digits) 1)))
               (index (quotient (- k 1) fact))
               (digit (list-ref digits index)))
          (string-append (number->string digit)
                         (perm-seq (append (take digits index) (drop digits (+ index 1)))
                                   (- k (* index fact)))))))
  (perm-seq digits k))