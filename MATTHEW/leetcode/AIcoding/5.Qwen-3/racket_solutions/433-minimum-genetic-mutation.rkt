#lang racket

(define (min-genetic-mutation start-gene end-gene bank)
  (define bank-set (set->hash (apply set (cons end-gene (string->list bank)))))
  (define (is-valid? gene)
    (and (set-member? bank-set gene) (not (equal? gene start-gene)))
    )
  (define (neighbors gene)
    (for/list ([i (in-range (string-length gene))]
               [c (in-string gene)])
      (for/list ([n '(#\A #\C #\G #\T)])
        (if (char=? c n)
            gene
            (string-append (substring gene 0 i) (string n) (substring gene (add1 i)))))))
  (define (bfs)
    (define q (queue))
    (enqueue! q (cons start-gene 0))
    (define visited (set start-gene))
    (let loop ()
      (when (not (queue-empty? q))
        (define current (dequeue! q))
        (define gene (car current))
        (define steps (cdr current))
        (when (equal? gene end-gene)
          (return steps))
        (for-each
         (lambda (neighbor)
           (when (and (set-member? bank-set neighbor)
                      (not (set-member? visited neighbor)))
             (set-add! visited neighbor)
             (enqueue! q (cons neighbor (add1 steps)))))
         (neighbors gene))
        (loop)))
    -1)
  (bfs))