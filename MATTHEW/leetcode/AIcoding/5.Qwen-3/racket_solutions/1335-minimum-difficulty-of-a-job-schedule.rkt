(define (min-jobs-schedule job-difficulties d)
  (define n (length job-difficulties))
  (when (> d n) (error "Not possible"))
  (define dp (make-vector (+ d 1) (make-vector (+ n 1) 0)))
  (for ([i (in-range 1 (+ d 1))])
    (vector-set! (vector-ref dp i) 0 0)
    (for ([j (in-range 1 (+ n 1))])
      (vector-set! (vector-ref dp i) j (vector-ref (vector-ref dp (- i 1)) (- j 1)))))
  (for ([i (in-range 1 (+ d 1))])
    (for ([j (in-range 1 (+ n 1))])
      (when (<= j n)
        (let ([current-max 0])
          (for ([k (in-range (- j 1) (- i 1) -1)])
            (set! current-max (max current-max (list-ref job-difficulties k)))
            (vector-set! (vector-ref dp i) j (min (vector-ref (vector-ref dp i) j) current-max)))))))
  (vector-ref (vector-ref dp d) n))