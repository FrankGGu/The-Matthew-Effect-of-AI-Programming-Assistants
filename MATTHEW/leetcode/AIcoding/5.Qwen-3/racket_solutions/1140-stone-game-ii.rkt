(define (stone-game-ii p)
  (define n (length p))
  (define dp (make-vector (+ n 1) 0))
  (define prefix (make-vector (+ n 1) 0))
  (for ([i (in-range n)])
    (vector-set! prefix i (+ (vector-ref prefix (- i 1)) (list-ref p i))))
  (for ([i (in-range (- n 1) -1 -1)])
    (vector-set! dp i
      (for/fold ([max-val 0])
                ([j (in-range (+ i 1) (+ n 1))])
        (max max-val (- (vector-ref prefix (- n 1))
                        (vector-ref prefix (- i 1))
                        (vector-ref dp j))))))
  (vector-ref dp 0))