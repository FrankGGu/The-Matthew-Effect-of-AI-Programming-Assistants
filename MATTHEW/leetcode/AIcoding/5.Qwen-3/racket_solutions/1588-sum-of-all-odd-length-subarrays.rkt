(define (sum-odd-length-subarrays arr)
  (define n (length arr))
  (define result 0)
  (for ([i (in-range n)])
    (define count 0)
    (define k 1)
    (let loop ()
      (when (<= k n)
        (set! count (+ count (if (even? k) 0 1)))
        (set! k (+ k 2))
        (loop)))
    (set! result (+ result (* (list-ref arr i) count))))
  result)