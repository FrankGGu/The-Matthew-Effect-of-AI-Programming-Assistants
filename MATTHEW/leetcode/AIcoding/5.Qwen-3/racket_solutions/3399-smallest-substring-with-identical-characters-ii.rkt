(define (smallest-substring-with-identical-characters-II s)
  (define n (string-length s))
  (define (min a b) (if (< a b) a b))
  (define (max a b) (if (> a b) a b))
  (define (char->index c) (- (char->integer c) (char->integer #\a)))
  (define last-index (make-vector 26 -1))
  (define result n)
  (for ([i (in-range n)])
    (let ([c (string-ref s i)])
      (when (>= (vector-ref last-index (char->index c)) 0)
        (set! result (min result (- i (vector-ref last-index (char->index c)))))
        (vector-set! last-index (char->index c) i))
      (when (< (vector-ref last-index (char->index c)) 0)
        (vector-set! last-index (char->index c) i)))
    (when (= result 1) (break)))
  (if (= result n) -1 result))