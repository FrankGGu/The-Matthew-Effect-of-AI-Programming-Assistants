(define (min-num-k-consecutive-bit-flips bits k)
  (let ((n (length bits))
        (flips 0)
        (result 0)
        (queue '()))
    (for ([i (in-range n)])
      (when (and (not (null? queue)) (= (car queue) i))
        (set! flips (- flips 1))
        (set! queue (cdr queue)))
      (when (= (list-ref bits i) 0)
        (set! result (+ result 1))
        (set! flips (+ flips 1))
        (set! queue (cons (+ i k) queue)))
      (when (> flips 0)
        (set! bits (list-update bits i (lambda (x) (if (= x 0) 1 0))))))
    result))