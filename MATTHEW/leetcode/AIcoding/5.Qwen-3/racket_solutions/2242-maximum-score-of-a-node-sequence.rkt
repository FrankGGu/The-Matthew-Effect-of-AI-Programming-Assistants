#lang racket

(define (max-score edges)
  (define n (length edges))
  (define adj (make-vector n '()))
  (for ([i (in-range n)])
    (define u i)
    (define v (list-ref edges i))
    (vector-set! adj u (cons v (vector-ref adj u)))
    (vector-set! adj v (cons u (vector-ref adj v))))

  (define (bfs start)
    (define dist (make-vector n -1))
    (define q (queue))
    (queue-add! q start)
    (vector-set! dist start 0)
    (let loop ()
      (when (not (queue-empty? q))
        (define u (queue-remove! q))
        (for ([v (vector-ref adj u)])
          (when (= (vector-ref dist v) -1)
            (vector-set! dist v (+ (vector-ref dist u) 1))
            (queue-add! q v)))
        (loop))
    dist))

  (define max-score 0)
  (for ([i (in-range n)])
    (for ([j (in-range n)])
      (when (not (= i j))
        (define dist-i (bfs i))
        (define dist-j (bfs j))
        (define score 0)
        (for ([k (in-range n)])
          (when (and (not (= k i)) (not (= k j)))
            (define d (+ (vector-ref dist-i k) (vector-ref dist-j k)))
            (set! score (max score d))))
        (set! max-score (max max-score score))))
  max-score)