#lang racket

(define (count-connected-components n)
  (define (gcd a b)
    (if (= b 0)
        a
        (gcd b (remainder a b))))
  (define (lcm a b)
    (/ (* a b) (gcd a b)))
  (define graph (make-hash))
  (for ([i (in-range 1 (add1 n))])
    (hash-set! graph i '()))
  (for ([i (in-range 1 (add1 n))])
    (for ([j (in-range 1 (add1 n))])
      (when (and (not (= i j)) (= (lcm i j) (* i j)))
        (hash-update! graph i (Î» (lst) (cons j lst))))))
  (define visited (make-hash))
  (define (dfs node)
    (when (not (hash-has-key? visited node))
      (hash-set! visited node #t)
      (for-each dfs (hash-ref graph node))))
  (define count 0)
  (for ([i (in-range 1 (add1 n))])
    (when (not (hash-has-key? visited i))
      (set! count (add1 count))
      (dfs i)))
  count)