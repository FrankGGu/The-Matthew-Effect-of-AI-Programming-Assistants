(define (longest-chunked-palindrome-decomposition s)
  (define (helper s)
    (let loop ((left 0) (right (sub1 (string-length s))) (count 0))
      (if (> left right)
          count
          (let ((left-char (string-ref s left))
                (right-char (string-ref s right)))
            (if (= left right)
                (+ count 1)
                (if (and (= left-char right-char)
                         (string=? (substring s 0 left) (substring s (add1 right) (string-length s))))
                    (loop (add1 left) (sub1 right) (+ count 1))
                    (loop (add1 left) right count)))))))
  (helper s))