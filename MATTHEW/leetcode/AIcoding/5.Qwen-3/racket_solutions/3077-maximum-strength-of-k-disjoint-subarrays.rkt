(define (max-k-disjoint-subarrays nums k)
  (define n (length nums))
  (define dp (make-vector (+ k 1) #f))
  (for ([i (in-range (+ k 1))])
    (vector-set! dp i (make-vector (+ n 1) -inf.0)))
  (vector-set! (vector-ref dp 0) 0 0)
  (for ([i (in-range 1 (+ k 1))])
    (for ([j (in-range n)])
      (let ([current-max -inf.0])
        (for ([m (in-range j)])
          (when (>= (vector-ref (vector-ref dp (- i 1)) m) -inf.0)
            (set! current-max (max current-max (+ (vector-ref (vector-ref dp (- i 1)) m) (sum-subarray nums m j)))))
          (vector-set! (vector-ref dp i) j current-max))))
  (define max-result -inf.0)
  (for ([i (in-range n)])
    (set! max-result (max max-result (vector-ref (vector-ref dp k) i))))
  max-result)

(define (sum-subarray nums start end)
  (define sum 0)
  (for ([i (in-range start end)])
    (set! sum (+ sum (list-ref nums i))))
  sum)