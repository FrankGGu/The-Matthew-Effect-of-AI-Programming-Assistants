(define (number-of-ways start-position target-position k)
  (define memo (make-hash))
  (define (dp pos steps)
    (cond ((and (= pos target-position) (= steps k)) 1)
          ((> steps k) 0)
          (else
           (hash-ref memo (cons pos steps) #f)))
    (if (hash-has-key? memo (cons pos steps))
        (hash-ref memo (cons pos steps))
        (let ((res (+ (dp (+ pos 1) (+ steps 1))
                      (dp (- pos 1) (+ steps 1)))))
          (hash-set! memo (cons pos steps) res)
          res)))
  (dp start-position 0))