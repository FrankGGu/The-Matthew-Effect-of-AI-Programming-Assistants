(define (last-stone-weight-ii stones)
  (define target (apply + stones))
  (define dp (make-vector (add1 target) #f))
  (vector-set! dp 0 #t)
  (for-each
   (lambda (stone)
     (let loop ((i (sub1 target)))
       (when (>= i 0)
         (when (vector-ref dp i)
           (vector-set! dp (+ i stone) #t))
         (loop (sub1 i)))))
   stones)
  (let loop ((i (sub1 target)))
    (if (vector-ref dp i)
        (- target (* 2 i))
        (loop (sub1 i)))))