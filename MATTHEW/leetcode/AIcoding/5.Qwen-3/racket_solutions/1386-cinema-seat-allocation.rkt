#lang racket

(define (max-occupied-seats n seats)
  (define (count-continuous zeros)
    (if (null? zeros)
        0
        (let loop ([zeros zeros] [count 0] [max 0])
          (if (null? zeros)
              (max max count)
              (if (= (car zeros) 0)
                  (loop (cdr zeros) (+ count 1) max)
                  (loop (cdr zeros) 0 (max max count)))))))

  (define (process-seat seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (count-continuous zeros)
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (get-max-seats seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (get-possible-seats seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (list current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-possible-seats seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (get-continuous-zeros seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (cons current zeros)
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (get-possible-allocations seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (list current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper2 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper3 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper4 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper5 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper6 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper7 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper8 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper9 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [zeros '()] [current 0])
        (if (= i (length seat-list))
            (max current (count-continuous zeros))
            (let ([c (list-ref seat-list i)])
              (if (char=? c #\0)
                  (loop (+ i 1) (append zeros (list 0)) current)
                  (loop (+ i 1) '() (max current (count-continuous zeros))))))))

  (define (max-occupied-seats-helper10 seat)
    (let ([seat-list (string->list seat)])
      (let loop ([i 0] [