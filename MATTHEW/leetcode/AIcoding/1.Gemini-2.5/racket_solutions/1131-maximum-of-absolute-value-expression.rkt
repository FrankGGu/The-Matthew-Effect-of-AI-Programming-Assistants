(define (max-abs-val-expr arr1 arr2)
  (let* ((n (vector-length arr1))
         (max-overall-diff 0))

    (define (calculate-max-diff s1 s2 s3)
      (let* ((initial-sum (+ (* s1 (vector-ref arr1 0))
                             (* s2 (vector-ref arr2 0))
                             (* s3 0)))
             (min-current-sum initial-sum)
             (max-current-sum initial-sum))
        (for ([k (in-range 1 n)])
          (let ((current-sum (+ (* s1 (vector-ref arr1 k))
                                (* s2 (vector-ref arr2 k))
                                (* s3 k))))
            (set! min-current-sum (min min-current-sum current-sum))
            (set! max-current-sum (max max-current-sum current-sum))))
        (- max-current-sum min-current-sum)))

    (set! max-overall-diff (max max-overall-diff (calculate-max-diff 1 1 1)))
    (set! max-overall-diff (max max-overall-diff (calculate-max-diff 1 1 -1)))
    (set! max-overall-diff (max max-overall-diff (calculate-max-diff 1 -1 1)))
    (set! max-overall-diff (max max-overall-diff (calculate-max-diff 1 -1 -1)))

    max-overall-diff))