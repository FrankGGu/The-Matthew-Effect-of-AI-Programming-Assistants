(define (count-beautiful-substrings s k)
  (define (is-vowel? char)
    (or (char=? char #\a)
        (char=? char #\e)
        (char=? char #\i)
        (char=? char #\o)
        (char=? char #\u)))

  (define n (string-length s))
  (define beautiful-count 0)

  (for ([i (in-range n)])
    (define vowel-count 0)
    (define consonant-count 0)
    (for ([j (in-range i n)])
      (define char (string-ref s j))
      (if (is-vowel? char)
          (set! vowel-count (+ vowel-count 1))
          (set! consonant-count (+ consonant-count 1)))

      (when (and (= vowel-count consonant-count)
                 (= (modulo (* vowel-count consonant-count) k) 0))
        (set! beautiful-count (+ beautiful-count 1)))))
  beautiful-count)