(define (find-original-array changed)
  (let* ((n (length changed)))
    (if (odd? n)
        '()
        (let ((freq (make-hash))
              (sorted-changed (sort changed <)))

          (for-each (lambda (x)
                      (hash-set! freq x (+ (hash-ref freq x 0) 1)))
                    sorted-changed)

          (let loop ((remaining-elements sorted-changed)
                     (acc-original '()))
            (if (null? remaining-elements)
                (reverse acc-original)
                (let* ((x (car remaining-elements))
                       (x-count (hash-ref freq x 0)))
                  (if (= x-count 0)
                      (loop (cdr remaining-elements) acc-original)
                      (let* ((doubled-x (* x 2))
                             (doubled-x-count (hash-ref freq doubled-x 0)))
                        (if (> doubled-x-count 0)
                            (begin
                              (hash-set! freq x (- x-count 1))
                              (hash-set! freq doubled-x (- doubled-x-count 1))
                              (loop (cdr remaining-elements) (cons x acc-original)))
                            '())))))))))