(define (queens-attack-the-king queens king)
  (let* ((kr (car king))
         (kc (cadr king))
         (board (make-vector 8 (lambda () (make-vector 8 #f))))
         (attacking-queens '()))

    (for-each (lambda (q)
                (let ((qr (car q))
                      (qc (cadr q)))
                  (vector-set! (vector-ref board qr) qc #t)))
              queens)

    (define directions '((-1 . 0)
                         (1 . 0)
                         (0 . -1)
                         (0 . 1)
                         (-1 . -1)
                         (-1 . 1)
                         (1 . -1)
                         (1 . 1)))

    (for-each (lambda (dir)
                (let* ((dr (car dir))
                       (dc (cdr dir)))
                  (let search-direction ((r (+ kr dr))
                                         (c (+ kc dc)))
                    (when (and (>= r 0) (< r 8) (>= c 0) (< c 8))
                      (if (vector-ref (vector-ref board r) c)
                          (set! attacking-queens (cons (list r c) attacking-queens))
                          (search-direction (+ r dr) (+ c dc)))))))
              directions)

    attacking-queens))