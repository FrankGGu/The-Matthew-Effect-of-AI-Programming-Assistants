(define (min-insertions s)
  (let* ((n (string-length s))
         (rev-s (string-reverse s))
         (dp (build-vector (+ n 1) (lambda (i) (make-vector (+ n 1) 0)))))
    (for* ((i (in-range 1 (+ n 1)))
           (j (in-range 1 (+ n 1))))
      (if (char=? (string-ref s (sub1 i)) (string-ref rev-s (sub1 j)))
          (vector-set! (vector-ref dp i) j (+ 1 (vector-ref (vector-ref dp (sub1 i)) (sub1 j))))
          (vector-set! (vector-ref dp i) j (max (vector-ref (vector-ref dp (sub1 i)) j)
                                                 (vector-ref (vector-ref dp i) (sub1 j))))))
    (- n (vector-ref (vector-ref dp n) n))))