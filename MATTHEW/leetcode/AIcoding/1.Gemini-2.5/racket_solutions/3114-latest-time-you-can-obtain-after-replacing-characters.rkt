(define (latest-time-you-can-obtain s)
  (let* ((c0 (string-ref s 0))
         (c1 (string-ref s 1))
         (c3 (string-ref s 3))
         (c4 (string-ref s 4)))
    (let-values (((h1-char h2-char)
                  (cond
                    ((and (char=? c0 #\?) (char=? c1 #\?)) (values #\2 #\3))
                    ((char=? c0 #\?)
                     (if (char<=? c1 #\3) (values #\2 c1) (values #\1 c1)))
                    ((char=? c1 #\?)
                     (if (char=? c0 #\2) (values c0 #\3) (values c0 #\9)))
                    (else (values c0 c1)))))
      (let ((m1-char (if (char=? c3 #\?) #\5 c3))
            (m2-char (if (char=? c4 #\?) #\9 c4)))
        (string h1-char h2-char #\: m1-char m2-char)))))