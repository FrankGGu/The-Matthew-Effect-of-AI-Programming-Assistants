(define (num-sub-with-only-1s s)
  (let* ((len (string-length s))
         (mod-val 1000000007))
    (let loop ((i 0)
               (current-ones 0)
               (total 0))
      (if (= i len)
          (modulo (+ total (quotient (* current-ones (+ current-ones 1)) 2)) mod-val)
          (let ((char (string-ref s i)))
            (if (char=? char #\1)
                (loop (+ i 1) (+ current-ones 1) total)
                (loop (+ i 1)
                      0
                      (modulo (+ total (quotient (* current-ones (+ current-ones 1)) 2)) mod-val))))))))